(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{273:function(a,s,t){"use strict";t.r(s);var e=t(0),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("div",{pre:!0},[t("h1",{pre:!0,attrs:{id:"laravel-envoy"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#laravel-envoy","aria-hidden":"true"}},[a._v("#")]),a._v(" Laravel Envoy")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#introduction"}},[a._v("Introducción")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#installation"}},[a._v("Instalación")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#writing-tasks"}},[a._v("Escribir tareas")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#setup"}},[a._v("Setup")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#variables"}},[a._v("Variables")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#stories"}},[a._v("Historias")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#multiple-servers"}},[a._v("Múltiples servidores")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#running-tasks"}},[a._v("Ejecutar tareas")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#confirming-task-execution"}},[a._v("Confirmar ejecución de tarea")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#notifications"}},[a._v("Notificaciones")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#slack"}},[a._v("Slack")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#discord"}},[a._v("Discord")])])])])]),a._v(" "),t("p",[t("a",{pre:!0,attrs:{name:"introduction"}})]),a._v(" "),t("h2",{pre:!0,attrs:{id:"introduccion"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#introduccion","aria-hidden":"true"}},[a._v("#")]),a._v(" Introducción")]),a._v(" "),t("p",[t("a",{pre:!0,attrs:{href:"https://github.com/laravel/envoy",target:"_blank",rel:"noopener noreferrer"}},[a._v("Laravel Envoy"),t("OutboundLink",{pre:!0})],1),a._v(" proporciona una sintaxis limpia y mínima para definir las tareas comunes que ejecutas en tus servidores remotos. Utilizando el estilo de sintaxis de Blade, puedes configurar fácilmente tareas para deploy, comandos de Artisan y más. Envoy solamente es compatible con sistemas operativos Mac y Linux.")]),a._v(" "),t("p",[t("a",{pre:!0,attrs:{name:"installation"}})]),a._v(" "),t("h3",{pre:!0,attrs:{id:"instalacion"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#instalacion","aria-hidden":"true"}},[a._v("#")]),a._v(" Instalación")]),a._v(" "),t("p",[a._v("Primero, instala Envoy utilizando el comando de composer "),t("code",[a._v("global require")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[a._v("composer "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("global")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("require")]),a._v(" laravel"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("envoy\n")])])]),t("p",[a._v("Dado que las librerías globales de Composer ocasionalmente pueden causar conflictos en la versión del paquete, puedes considerar utilizar "),t("code",[a._v("cgr")]),a._v(", el cual es un reemplazo directo para el comando "),t("code",[a._v("composer global require")]),a._v(". Las instrucciones de instalación de la librería "),t("code",[a._v("gcr")]),a._v(" pueden ser "),t("a",{pre:!0,attrs:{href:"https://github.com/consolidation-org/cgr",target:"_blank",rel:"noopener noreferrer"}},[a._v("encontradas en GitHub"),t("OutboundLink",{pre:!0})],1),a._v(".")]),a._v(" "),t("div",{pre:!0,attrs:{class:"danger custom-block"}},[t("p",{pre:!0,attrs:{class:"custom-block-title"}},[a._v("Nota")]),a._v(" "),t("p",[a._v("Asegurate de colocar el directorio "),t("code",[a._v("~/.composer/vendor/bin")]),a._v(" en tu PATH para que el ejecutable "),t("code",[a._v("envoy")]),a._v(" pueda ser localizado cuando se ejecute el comando "),t("code",[a._v("envoy")]),a._v(" en tu terminal.")])])]),t("h4",{attrs:{id:"actualizar-envoy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#actualizar-envoy","aria-hidden":"true"}},[a._v("#")]),a._v(" Actualizar envoy")]),a._v(" "),t("p",[a._v("También puedes usar Composer para mantener tu instalación de Envoy actualizada. Ejecutar el comando "),t("code",[a._v("composer global update")]),a._v(" actualizará todos tus paquetes de Composer instalados globalmente:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("composer "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("global")]),a._v(" update\n")])])]),t("p",[t("a",{attrs:{name:"writing-tasks"}})]),a._v(" "),t("h2",{attrs:{id:"escribir-tareas"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#escribir-tareas","aria-hidden":"true"}},[a._v("#")]),a._v(" Escribir tareas")]),a._v(" "),t("p",[a._v("Todas tus tareas de Envoy deberán definirse en un archivo "),t("code",[a._v("Envoy.blade.php")]),a._v(" en la raíz de tu proyecto. Aquí un ejemplo para comenzar:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("servers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'user@192.168.1.1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'foo'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'on'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    ls "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("la\n@endtask\n")])])]),t("p",[a._v("Como puedes ver, un arreglo "),t("code",[a._v("@servers")]),a._v(" es definido en la parte superior del archivo, permitiéndote hacer referencia a estos servidores en la opción "),t("code",[a._v("on")]),a._v(" en la declaración de tus tareas. Dentro de tus declaraciones "),t("code",[a._v("@task")]),a._v(", deberás colocar el código Bash que se deberá ejecutar en tu servidor una vez que la tarea sea ejecutada.")]),a._v(" "),t("p",[a._v("Puedes forzar que un script se ejecute localmente especificando la dirección IP del servidor como "),t("code",[a._v("127.0.0.1")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("servers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'localhost'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'127.0.0.1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"setup"}})]),a._v(" "),t("h3",{attrs:{id:"setup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setup","aria-hidden":"true"}},[a._v("#")]),a._v(" Setup")]),a._v(" "),t("p",[a._v("En ocasiones, puede que necesites ejecutar algún código PHP antes de tus tareas de Envoy. Puedes hacer uso de la directiva "),t("code",[a._v("@setup")]),a._v(" para declarar variables y hacer uso de PHP en general antes de que tus otras tareas sean ejecutadas:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@setup\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$now")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("DateTime")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$environment")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("isset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("?")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$env")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[a._v('"testing"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n@endsetup\n")])])]),t("p",[a._v("Si necesitas de otros archivos PHP antes de ejecutar tus tareas, puedes utilizar la directiva "),t("code",[a._v("@include")]),a._v(" en la parte superior de tu archivo "),t("code",[a._v("Envoy.blade.php")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("include")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'vendor/autoload.php'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'foo'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token shell-comment comment"}},[a._v("# ...")]),a._v("\n@endtask\n")])])]),t("p",[t("a",{attrs:{name:"variables"}})]),a._v(" "),t("h3",{attrs:{id:"variables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#variables","aria-hidden":"true"}},[a._v("#")]),a._v(" Variables")]),a._v(" "),t("p",[a._v("Si es necesario, puedes pasar valores de opciones a las tareas de Envoy usando la línea de comandos:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("envoy run deploy "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("branch"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("master\n")])])]),t("p",[a._v('Puedes acceder a las opciones en tus tareas por medio de la sintaxis "echo" de Blade. También puedes usar declaraciones '),t("code",[a._v("if")]),a._v(" y bucles dentro de tus tareas. Por ejemplo, para verificar la presencia de la variable "),t("code",[a._v("$branch")]),a._v(" antes de ejecutar el comando "),t("code",[a._v("git pull")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("servers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'192.168.1.1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'deploy'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'on'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    cd site\n\n    @"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$branch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        git pull origin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$branch")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    @"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("endif")]),a._v("\n\n    php artisan migrate\n@endtask\n")])])]),t("p",[t("a",{attrs:{name:"stories"}})]),a._v(" "),t("h3",{attrs:{id:"historias"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#historias","aria-hidden":"true"}},[a._v("#")]),a._v(" Historias")]),a._v(" "),t("p",[a._v("Las historias agrupan un conjunto de tareas con un nombre único y conveniente, permitiendo agrupar tareas pequeñas enfocandose en tareas más grandes. Por ejemplo, una historia "),t("code",[a._v("deploy")]),a._v(" puede ejecutar las tareas "),t("code",[a._v("git")]),a._v(" y "),t("code",[a._v("composer")]),a._v(" al listar los nombres de las tareas en tu definición:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("servers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'192.168.1.1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("story")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'deploy'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    git\n    composer\n@endstory\n\n@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'git'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    git pull origin master\n@endtask\n\n@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'composer'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    composer install\n@endtask\n")])])]),t("p",[a._v("Una vez que hayas finalizado de escribir tu historia, puedes ejecutarla como una tarea típica:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("envoy run deploy\n")])])]),t("p",[t("a",{attrs:{name:"multiple-servers"}})]),a._v(" "),t("h3",{attrs:{id:"multiples-servidores"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#multiples-servidores","aria-hidden":"true"}},[a._v("#")]),a._v(" Múltiples servidores")]),a._v(" "),t("p",[a._v("Envoy te permite fácilmente ejecutar tareas a través de múltiples servidores. Primero, agrega servidores adicionales a tu declaración "),t("code",[a._v("@servers")]),a._v(". A cada servidor se le debe asignar un nombre único. Una vez definidos los servidores adicionales, deberás indicar en cuáles servidores se van a ejecutar las tareas, esto puede hacerse en el arreglo "),t("code",[a._v("on")]),a._v(" de cada tarea:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("servers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web-1'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'192.168.1.1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web-2'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'192.168.1.2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'deploy'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'on'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web-1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web-2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    cd site\n    git pull origin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$branch")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    php artisan migrate\n@endtask\n")])])]),t("h4",{attrs:{id:"ejecucion-paralela"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ejecucion-paralela","aria-hidden":"true"}},[a._v("#")]),a._v(" Ejecución paralela")]),a._v(" "),t("p",[a._v("Por defecto, las tareas serán ejecutadas en cada servidor en serie. En otras palabras, una tarea finaliza su ejecución en el primer servidor antes de proceder a ejecutarse en el segundo servidor. Si deseas ejecutar una tarea a través de múltiples servidores en paralelo, agrega la opción "),t("code",[a._v("parallel")]),a._v(" a la declaración de tu tarea:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("servers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web-1'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'192.168.1.1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web-2'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'192.168.1.2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'deploy'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'on'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web-1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web-2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'parallel'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean constant"}},[a._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    cd site\n    git pull origin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$branch")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    php artisan migrate\n@endtask\n")])])]),t("p",[t("a",{attrs:{name:"running-tasks"}})]),a._v(" "),t("h2",{attrs:{id:"ejecutar-tareas"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ejecutar-tareas","aria-hidden":"true"}},[a._v("#")]),a._v(" Ejecutar tareas")]),a._v(" "),t("p",[a._v("Para ejecutar una tarea o historia que esté definida en tu archivo "),t("code",[a._v("Envoy.blade.php")]),a._v(", ejecuta el comando de Envoy "),t("code",[a._v("run")]),a._v(", pasando el nombre de la tarea o historia que deseas ejecutar. Envoy va a ejecutar la tarea y mostrará el resultado de los servidores mientras se ejecuta la tarea:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("envoy run deploy\n")])])]),t("p",[t("a",{attrs:{name:"confirming-task-execution"}})]),a._v(" "),t("h3",{attrs:{id:"confirmar-ejecucion-de-tarea"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#confirmar-ejecucion-de-tarea","aria-hidden":"true"}},[a._v("#")]),a._v(" Confirmar ejecución de tarea")]),a._v(" "),t("p",[a._v("Si deseas que se solicite confirmación antes de ejecutar una tarea en tus servidores, deberás añadir la directiva "),t("code",[a._v("confirm")]),a._v(" a la declaración de tu tarea. Esta opción es particularmente útil para operaciones destructivas:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'deploy'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'on'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'confirm'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean constant"}},[a._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    cd site\n    git pull origin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$branch")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    php artisan migrate\n@endtask\n")])])]),t("p",[t("a",{attrs:{name:"notifications"}})]),a._v(" "),t("h2",{attrs:{id:"notificaciones"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#notificaciones","aria-hidden":"true"}},[a._v("#")]),a._v(" Notificaciones")]),a._v(" "),t("p",[t("a",{attrs:{name:"slack"}})]),a._v(" "),t("h3",{attrs:{id:"slack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#slack","aria-hidden":"true"}},[a._v("#")]),a._v(" Slack")]),a._v(" "),t("p",[a._v("Envoy también permite enviar notificaciones a "),t("a",{attrs:{href:"https://slack.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("Slack"),t("OutboundLink")],1),a._v(" después de ejecutar cada tarea. La directiva "),t("code",[a._v("@slack")]),a._v(' acepta una URL de webhook a Slack y un nombre de canal. Puedes recuperar tu URL de webhook creando una integración "Incoming WebHooks" en el panel de control de Slack. Debes pasar la URL de webhook completa en la directiva '),t("code",[a._v("@slack")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@finished\n    @"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("slack")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'webhook-url'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'#bots'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n@endfinished\n")])])]),t("p",[a._v("Puedes proporcionar uno de los siguientes como el argumento del canal:")]),a._v(" "),t("ul",[t("li",[a._v("Para enviar notificaciones a un canal: "),t("code",[a._v("#canal")])]),a._v(" "),t("li",[a._v("Para enviar notificaciones a un usuario: "),t("code",[a._v("@usuario")])])]),a._v(" "),t("p",[t("a",{attrs:{name:"discord"}})]),a._v(" "),t("h3",{attrs:{id:"discord"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#discord","aria-hidden":"true"}},[a._v("#")]),a._v(" Discord")]),a._v(" "),t("p",[a._v("Envoy también soporta el envío de notificaciones a "),t("a",{attrs:{href:"https://discord.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("Discord"),t("OutboundLink")],1),a._v(" después de que cada tarea es ejecutada. La dirctiva "),t("code",[a._v("@discord")]),a._v(' acepta una URL WebHook y un mensaje de Discord. Puedes recuperar tu URL webhook creando una "Webhook" en los ajustes de tu servidor y seleccionando en cuál canal publicar la webhook. También deberías pasar la URL de Webhook completa en la directiva '),t("code",[a._v("@discord")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("@finished\n    @"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("discord")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'discord-webhook-url'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n@endfinished\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);