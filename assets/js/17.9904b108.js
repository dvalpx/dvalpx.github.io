(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{247:function(a,s,t){"use strict";t.r(s);var e=t(0),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("div",{pre:!0},[t("h1",{pre:!0,attrs:{id:"broadcasting"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#broadcasting"}},[a._v("#")]),a._v(" Broadcasting")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#introduction"}},[a._v("Introducción")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#configuration"}},[a._v("Configuración")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#driver-prerequisites"}},[a._v("Prerrequisitos del driver")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#concept-overview"}},[a._v("Descripción general")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#using-example-application"}},[a._v("Usando una aplicación de ejemplo")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#defining-broadcast-events"}},[a._v("Definiendo eventos de transmisión")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#broadcast-name"}},[a._v("Nombre de la transmisión")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#broadcast-data"}},[a._v("Datos de la transmisión")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#broadcast-queue"}},[a._v("Cola de la transmisión")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#broadcast-conditions"}},[a._v("Condiciones de la transmisión")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#authorizing-channels"}},[a._v("Autorizando canales")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#defining-authorization-routes"}},[a._v("Definiendo rutas de autorización")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#defining-authorization-callbacks"}},[a._v("Definiendo callbacks de autorización")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#defining-channel-classes"}},[a._v("Definiendo clases de canales")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#broadcasting-events"}},[a._v("Transmitiendo eventos")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#only-to-others"}},[a._v("Sólo a otros")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#receiving-broadcasts"}},[a._v("Recibiendo transmisiones")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#installing-laravel-echo"}},[a._v("Instalando Laravel Echo")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#listening-for-events"}},[a._v("Escuchando eventos")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#leaving-a-channel"}},[a._v("Dejando un canal")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#namespaces"}},[a._v("Nombres de espacio")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#presence-channels"}},[a._v("Canales de presencia")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#authorizing-presence-channels"}},[a._v("Autorizando canales de presencia")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#joining-presence-channels"}},[a._v("Uniéndose a canales de presencia")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#broadcasting-to-presence-channels"}},[a._v("Transmitiendo a canales de presencia")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#client-events"}},[a._v("Eventos del cliente")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#notifications"}},[a._v("Notificaciones")])])]),a._v(" "),t("p",[t("a",{pre:!0,attrs:{name:"introduction"}})]),a._v(" "),t("h2",{pre:!0,attrs:{id:"introduccion"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#introduccion"}},[a._v("#")]),a._v(" Introducción")]),a._v(" "),t("p",[a._v("En muchas aplicaciones web modernas, los WebSockets son usados para implementar interfaces de usuarios actualizadas en tiempo real. Cuando algún dato es actualizado en el servidor, un mensaje es típicamente enviado a través de una conexión WebSocket para ser manejado por el cliente. Esto proporciona una alternativa más robusta y eficiente para monitorear continuamente tu aplicación en busca de cambios.")]),a._v(" "),t("p",[a._v('Para asistirte en la construcción de ese tipo de aplicaciones, Laravel hace fácil "emitir" tus '),t("router-link",{pre:!0,attrs:{to:"/events.html"}},[a._v("eventos")]),a._v(" a través de una conexión WebSocket. Emitir tus eventos te permite compartir los mismos nombres de eventos entre tu código del lado del servidor y tu aplicación JavaScript del lado de cliente.")],1),a._v(" "),t("div",{pre:!0,attrs:{class:"custom-block tip"}},[t("p",{pre:!0,attrs:{class:"custom-block-title"}},[a._v("TIP")]),a._v(" "),t("p",[a._v("Antes de sumergirnos en la emisión de eventos, asegurate de haber leído toda la documentación de Laravel sobre "),t("router-link",{pre:!0,attrs:{to:"/events.html"}},[a._v("eventos y listeners")]),a._v(".")],1)])]),t("p",[t("a",{attrs:{name:"configuration"}})]),a._v(" "),t("h3",{attrs:{id:"configuracion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configuracion"}},[a._v("#")]),a._v(" Configuración")]),a._v(" "),t("p",[a._v("Toda la configuración de transmisión de eventos de tu aplicación está almacenada en el archivo de configuración "),t("code",[a._v("config/broadcasting.php")]),a._v(". Laravel soporta múltiples drivers de transmisión: "),t("a",{attrs:{href:"https://pusher.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("canales de Pusher"),t("OutboundLink")],1),a._v(", "),t("router-link",{attrs:{to:"/redis.html"}},[a._v("Redis")]),a._v(" y un driver "),t("code",[a._v("log")]),a._v(" para desarrollo local y depuración. Adicionalmente, un driver "),t("code",[a._v("null")]),a._v(" es incluido, que te permite deshabilitar totalmente las emisiones. Un ejemplo de configuración para cada uno de los drivers está incluido en el archivo de configuración "),t("code",[a._v("config/broadcasting.php")]),a._v(".")],1),a._v(" "),t("h4",{attrs:{id:"proveedor-de-servicios-broadcast"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#proveedor-de-servicios-broadcast"}},[a._v("#")]),a._v(" Proveedor de servicios Broadcast")]),a._v(" "),t("p",[a._v("Antes de transmitir cualquier evento, necesitarás primero registrar "),t("code",[a._v("App\\Providers\\BroadcastServiceProvider")]),a._v(". En aplicaciones de Laravel nuevas, sólo necesitas descomentar este proveedor en el arreglo "),t("code",[a._v("providers")]),a._v(" de tu archivo de configuración "),t("code",[a._v("config/app.php")]),a._v(". Este proveedor te permitirá registrar las rutas de autorización del broadcast y los callbacks.")]),a._v(" "),t("h4",{attrs:{id:"token-csrf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#token-csrf"}},[a._v("#")]),a._v(" Token CSRF")]),a._v(" "),t("p",[t("a",{attrs:{href:"#installing-laravel-echo"}},[a._v("Laravel Echo")]),a._v(" necesitará acceso al token CSRF de la sesión actual. Debes verificar que el elemento HTML "),t("code",[a._v("head")]),a._v(" de tu aplicación define una etiqueta "),t("code",[a._v("meta")]),a._v(" que contiene el token CSRF:")]),a._v(" "),t("div",{staticClass:"language-html extra-class"},[t("pre",{pre:!0,attrs:{class:"language-html"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("meta")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("csrf-token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("content")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("{{ csrf_token() }}"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"driver-prerequisites"}})]),a._v(" "),t("h3",{attrs:{id:"prerrequisitos-del-driver"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerrequisitos-del-driver"}},[a._v("#")]),a._v(" Prerrequisitos del driver")]),a._v(" "),t("h4",{attrs:{id:"canales-de-pusher"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#canales-de-pusher"}},[a._v("#")]),a._v(" Canales de Pusher")]),a._v(" "),t("p",[a._v("Si estás transmitiendo tus eventos mediante "),t("a",{attrs:{href:"https://pusher.com/channels",target:"_blank",rel:"noopener noreferrer"}},[a._v("canales de Pusher"),t("OutboundLink")],1),a._v(", debes instalar el SDK de PHP para canales de Pusher mediante el administrador de paquetes Composer:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("composer require pusher/pusher-php-server "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"~4.0"')]),a._v("\n")])])]),t("p",[a._v("Luego, debes configurar tus credenciales del canal en el archivo de configuración "),t("code",[a._v("config/broadcasting.php")]),a._v(". Un ejemplo de configuración de canal está incluido en este archivo, permitiéndote especificar rápidamente la clave del canal, contraseña y ID de la aplicación. La configuración de "),t("code",[a._v("pusher")]),a._v(" del archivo "),t("code",[a._v("config/broadcasting.php")]),a._v(" también te permite especificar "),t("code",[a._v("options")]),a._v(" adicionales que son soportadas por canales, como el cluster:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'options'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'cluster'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'eu'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'useTLS'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean constant"}},[a._v("true")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n")])])]),t("p",[a._v("Al usar canales y "),t("a",{attrs:{href:"#installing-laravel-echo"}},[a._v("Laravel Echo")]),a._v(", debes especificar "),t("code",[a._v("pusher")]),a._v(" como tu transmisor deseado al instanciar la instancia de Echo en tu archivo "),t("code",[a._v("resources/js/bootstrap.js")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("import "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" from "),t("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[a._v('"laravel-echo"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nwindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Pusher "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'pusher-js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nwindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    broadcaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'pusher'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'your-pusher-channels-key'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{attrs:{id:"redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redis"}},[a._v("#")]),a._v(" Redis")]),a._v(" "),t("p",[a._v("Si estás usando el transmisor de Redis, debes instalar ya sea la extensión de PHP phpredis mediante PECL o instalar la librería Predis mediante Composer:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("composer "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("require")]),a._v(" predis"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("predis\n")])])]),t("p",[a._v("El transmisor de Redis transmitirá mensajes usando las característica pub / sub de Redis; sin embargo, necesitarás unir esto con un servidor de WebSocket que puede recibir mensajes desde Redis y emitirlos a tus canales de WebSocket.")]),a._v(" "),t("p",[a._v("Cuando el transmisor de Redis publica un evento, éste será publicado en los nombres de canales especificados en el evento y la carga será una cadena codificada de JSON que contiene el nombre del evento, una carga "),t("code",[a._v("data")]),a._v(" y el usuario que genero el ID de socket del evento (si aplica).")]),a._v(" "),t("h4",{attrs:{id:"socket-io"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#socket-io"}},[a._v("#")]),a._v(" Socket.IO")]),a._v(" "),t("p",[a._v("Si vas a unir el transmisor de Redis con un servidor Socket.IO, necesitarás incluir la librería de Socket.IO en tu aplicación. Puedes instalarla mediante el gestor de paquetes NPM:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("npm install "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("save socket"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("io"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("client\n")])])]),t("p",[a._v("Luego, necesitarás instanciar Echo con el conector "),t("code",[a._v("socket.io")]),a._v(" y un "),t("code",[a._v("host")]),a._v(".")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("import "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" from "),t("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[a._v('"laravel-echo"')]),a._v("\n\nwindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("io "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'socket.io-client'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nwindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    broadcaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'socket.io'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    host"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("location"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("hostname "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("':6001'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Finalmente, necesitarás ejecutar un servidor de Socket.IO compatible. Laravel no incluye la implementación de un servidor Socket.IO; sin embargo, un servidor de Socket.IO de la comunidad es actualmente mantenido en el repositorio de GitHub "),t("a",{attrs:{href:"https://github.com/tlaverdure/laravel-echo-server",target:"_blank",rel:"noopener noreferrer"}},[a._v("tlaverdure/laravel-echo-server"),t("OutboundLink")],1),a._v(".")]),a._v(" "),t("h4",{attrs:{id:"prerrequisitos-de-la-cola"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerrequisitos-de-la-cola"}},[a._v("#")]),a._v(" Prerrequisitos de la cola")]),a._v(" "),t("p",[a._v("Antes de transmitir eventos, también necesitarás configurar y ejecutar un "),t("router-link",{attrs:{to:"/queues.html"}},[a._v("listener de colas")]),a._v(". Toda la transmisión de eventos es realizada mediante trabajos en cola para que el tiempo de respuesta de tu aplicación no se vea necesariamente afectado.")],1),a._v(" "),t("p",[t("a",{attrs:{name:"concept-overview"}})]),a._v(" "),t("h2",{attrs:{id:"descripcion-general"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#descripcion-general"}},[a._v("#")]),a._v(" Descripción general")]),a._v(" "),t("p",[a._v("La transmisión de eventos de Laravel te permite transmitir tus eventos del lado del servidor de Laravel a tu aplicación JavaScript del lado del cliente usando un enfoque basado en drivers a los WebSockets. Actualmente, Laravel viene con drivers de "),t("a",{attrs:{href:"https://pusher.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("canales de Pusher"),t("OutboundLink")],1),a._v(" y Redis. Los eventos pueden ser fácilmente consumidos en el lado del cliente usando el paquete de JavaScript "),t("a",{attrs:{href:"#installing-laravel-echo"}},[a._v("Laravel Echo")]),a._v(".")]),a._v(" "),t("p",[a._v('Los eventos son transmitidos mediante "canales", que pueden ser definidos como públicos o privados. Cualquier visitante en tu aplicación puede suscribirse a una canal público sin necesidad de autenticación o autorización; sin embargo, para poder suscribirse a canales privados, un usuario debe estar autenticado y autorizado para escuchar en dicho canal.')]),a._v(" "),t("p",[t("a",{attrs:{name:"using-example-application"}})]),a._v(" "),t("h3",{attrs:{id:"usando-una-aplicacion-de-ejemplo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#usando-una-aplicacion-de-ejemplo"}},[a._v("#")]),a._v(" Usando una aplicación de ejemplo")]),a._v(" "),t("p",[a._v("Antes de sumergirnos en cada componente de la transmisión de eventos, vamos a ver un resumen usando una tienda virtual como ejemplo. No discutiremos los detalles sobre configurar "),t("a",{attrs:{href:"https://pusher.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("canales de Pusher"),t("OutboundLink")],1),a._v(" o "),t("a",{attrs:{href:"#installing-laravel-echo"}},[a._v("Laravel Echo")]),a._v(" dado que éstos será discutido a detalle en otras secciones de esta documentación.")]),a._v(" "),t("p",[a._v("En nuestra aplicación, vamos a asumir que tenemos una página que permite a los usuarios ver el estado de envío de sus ordenes. Vamos también a asumir que un evento "),t("code",[a._v("ShippingStatusUpdated")]),a._v(" es ejecutado cuando un estado de envío es procesado por la aplicación:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("event")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ShippingStatusUpdated")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{attrs:{id:"interfaz-shouldbroadcast"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#interfaz-shouldbroadcast"}},[a._v("#")]),a._v(" Interfaz "),t("code",[a._v("ShouldBroadcast")])]),a._v(" "),t("p",[a._v("Cuando un usuario está viendo una de sus ordenes, no que queremos que tengan que refrescar la página para ver las actualizaciones del estado. En su lugar, queremos transmitir las actualizaciones a la aplicación a medida que son creadas. Así que, necesitamos marcar el evento "),t("code",[a._v("ShippingStatusUpdated")]),a._v(" con la interfaz "),t("code",[a._v("ShouldBroadcast")]),a._v(". Esto instruirá a Laravel para que transmita el evento cuando es ejecutado:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token php language-php"}},[t("span",{pre:!0,attrs:{class:"token delimiter important"}},[a._v("<?php")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("namespace")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Events")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("InteractsWithSockets")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("PresenceChannel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("PrivateChannel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Contracts"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("ShouldBroadcast")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Queue"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("SerializesModels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ShippingStatusUpdated")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("implements")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ShouldBroadcast")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n    * Information about the shipping status update.\n    *\n    * @var string\n    */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])])]),t("p",[a._v("La interfaz "),t("code",[a._v("ShouldBroadcast")]),a._v(" requiere que nuestro evento defina un método "),t("code",[a._v("broadcastOn")]),a._v(". Este método es responsable de retornar los canales en los que el evento debería transmitir. Un stub vacío para este metodo está definido en las clases de eventos generadas, así que sólo necesitamos rellenar sus detalles. Sólo queremos que el creador de la orden sea capaz de ver las actualizaciones de estado, así que transmitiremos el evento en un canal privado que está enlazado a la orden:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n* Get the channels the event should broadcast on.\n*\n* @return \\Illuminate\\Broadcasting\\PrivateChannel\n*/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcastOn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("PrivateChannel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'order.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$this")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("update")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("order_id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("h4",{attrs:{id:"autorizando-canales"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#autorizando-canales"}},[a._v("#")]),a._v(" Autorizando canales")]),a._v(" "),t("p",[a._v("Recuerda, los usuarios deben ser autorizados para escuchar en canales privados. Podemos definir las reglas de autorización de nuestro canal en el archivo "),t("code",[a._v("routes/channels.php")]),a._v(". En este ejemplo, necesitamos verificar que cualquier usuario intentando escuchar en el canal privado "),t("code",[a._v("order.1")]),a._v(" es realmente el creador de la orden:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("Broadcast"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'order.{orderId}'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$orderId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("===")]),a._v(" Order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("findOrNew")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$orderId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("user_id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("El método "),t("code",[a._v("channel")]),a._v(" acepta dos argumentos: el nombre del canal y un callback que retorna "),t("code",[a._v("true")]),a._v(" o "),t("code",[a._v("false")]),a._v(" indicando si el usuario está autorizado para escuchar en el canal.")]),a._v(" "),t("p",[a._v("Todos los callbacks de autorización recibien al usuario actualmente autenticado como primer argumento y cualquier paremetro adicional como siguientes argumentos. En este ejemplo, estamos usando el placeholder "),t("code",[a._v("{orderId}")]),a._v(' para indicar que la porción "ID" del nombre del canal es un wildcard.')]),a._v(" "),t("h4",{attrs:{id:"escuchar-transmisiones-de-eventos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#escuchar-transmisiones-de-eventos"}},[a._v("#")]),a._v(" Escuchar transmisiones de eventos")]),a._v(" "),t("p",[a._v("Luego, todo lo que queda es escuchar el evento en nuestra aplicación de JavaScript. Podemos hacer esto usando Laravel Echo. Primero, usaremos el método "),t("code",[a._v("private")]),a._v(" para suscribirnos a un canal privado. Luego, podemos usar el método "),t("code",[a._v("listen")]),a._v(" para escuchar el evento "),t("code",[a._v("ShippingStatusUpdated")]),a._v(". Por defecto, todas las propiedades públicas del evento serán incluidas en el evento de transmisión:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("`order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("orderId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'ShippingStatusUpdated'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("update"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"defining-broadcast-events"}})]),a._v(" "),t("h2",{attrs:{id:"definiendo-la-transmision-de-eventos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#definiendo-la-transmision-de-eventos"}},[a._v("#")]),a._v(" Definiendo la transmisión de eventos")]),a._v(" "),t("p",[a._v("Para informar a Laravel que un evento dado debería ser transmitido, implementa la interfaz "),t("code",[a._v("Illuminate\\Contracts\\Broadcasting\\ShouldBroadcast")]),a._v(" en la clase del evento. Esta interfaz ya está importada en todas las clases de eventos generadas por el framework para que así puedas agregarla fácilmente a tus eventos.")]),a._v(" "),t("p",[a._v("La interfaz "),t("code",[a._v("ShouldBroadcast")]),a._v(" requiere que implementes un sólo método: "),t("code",[a._v("broadcastOn")]),a._v(". El método "),t("code",[a._v("broadcastOn")]),a._v(" debería retornar un canal o un arreglo de canales en los que el evento debería transmitirse. Los canales deben ser instancias de "),t("code",[a._v("Channel")]),a._v(", "),t("code",[a._v("PrivateChannel")]),a._v(" o "),t("code",[a._v("PresenceChannel")]),a._v(". Las instancias de "),t("code",[a._v("Channel")]),a._v(" representan canales públicos a los que cualquier usuario puede suscribirse mientras que "),t("code",[a._v("PrivateChannels")]),a._v(" y "),t("code",[a._v("PresenceChannels")]),a._v(" representan canales privados que requieren "),t("a",{attrs:{href:"#authorizing-channels"}},[a._v("autorización")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token php language-php"}},[t("span",{pre:!0,attrs:{class:"token delimiter important"}},[a._v("<?php")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("namespace")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Events")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("User")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("InteractsWithSockets")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("PresenceChannel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("PrivateChannel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Contracts"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("ShouldBroadcast")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Queue"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("SerializesModels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ServerCreated")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("implements")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ShouldBroadcast")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("SerializesModels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n    * Create a new event instance.\n    *\n    * @return void\n    */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("__construct")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("User "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$this")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n    * Get the channels the event should broadcast on.\n    *\n    * @return Channel|array\n    */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcastOn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("PrivateChannel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'user.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$this")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])])]),t("p",[a._v("Luego, sólo necesitas "),t("router-link",{attrs:{to:"/events.html"}},[a._v("ejecutar el evento")]),a._v(" como normalmente lo harías. Una vez que el evento ha sido ejecutado, "),t("router-link",{attrs:{to:"/queues.html"}},[a._v("un trabajo en cola")]),a._v(" transmitirá automáticamente el evento a través de tu driver de transmisión especificado.")],1),a._v(" "),t("p",[t("a",{attrs:{name:"broadcast-name"}})]),a._v(" "),t("h3",{attrs:{id:"nombre-de-la-transmision"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nombre-de-la-transmision"}},[a._v("#")]),a._v(" Nombre de la transmisión")]),a._v(" "),t("p",[a._v("Por defecto, Laravel transmitirá el evento usando el nombre de clase del evento. Sin embargo, puedes personalizar el nombre de la transmisión definiendo un método "),t("code",[a._v("broadcastAs")]),a._v(" en el evento:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n* The event's broadcast name.\n*\n* @return string\n*/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcastAs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'server.created'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[a._v("Si personalizas el nombre de la transmisión usando el método "),t("code",[a._v("broadcastAs")]),a._v(", debes asegurarte de registrar tu listener prefijándolo con un caracter "),t("code",[a._v(".")]),a._v(". Esto instruíra a Echo a no agregar el nombre de espacio de la aplicación al evento:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'.server.created'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"broadcast-data"}})]),a._v(" "),t("h3",{attrs:{id:"datos-de-la-transmision"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#datos-de-la-transmision"}},[a._v("#")]),a._v(" Datos de la transmisión")]),a._v(" "),t("p",[a._v("Cuando un evento es transmitido, todas sus propiedades "),t("code",[a._v("public")]),a._v(" son automáticamente serializadas y transmitidas como carga del evento, permitiéndote acceder a cualquiera de sus datos públicos desde tu aplicación de JavaScript. Así que, por ejemplo, si tu evento tiene una sola propiedad pública "),t("code",[a._v("$user")]),a._v(" que contiene un modelo de Eloquent, la carga de transmisión del evento sería:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[a._v('"user"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[a._v('"id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[a._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[a._v('"Patrick Stewart"')]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[a._v("Sin embargo, si deseas tener mayor control sobre la carga transmitida, puedes agregar un método "),t("code",[a._v("broadcastWith")]),a._v(" a tu evento. Este método debería retornar el arreglo de datos que deseas transmitir como la carga del evento:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n* Get the data to broadcast.\n*\n* @return array\n*/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcastWith")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'id'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$this")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"broadcast-queue"}})]),a._v(" "),t("h3",{attrs:{id:"cola-de-transmision"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cola-de-transmision"}},[a._v("#")]),a._v(" Cola de transmisión")]),a._v(" "),t("p",[a._v("Por defecto, cada evento transmitido es colocado en la cola por defecto para la conexión de cola por defecto especificada en tu archivo de configuración "),t("code",[a._v("queue.php")]),a._v(". Puedes personalizar la cola usada por el transmisor definiendo una propiedad "),t("code",[a._v("broadcastQueue")]),a._v(" en la clase de tu evento. Esta propiedad debería especificar el nombre de la cola que deseas usar al transmitir:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n* The name of the queue on which to place the event.\n*\n* @var string\n*/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$broadcastQueue")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'your-queue-name'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Si quieres transmitir tu evento usando la cola "),t("code",[a._v("sync")]),a._v(" en lugar del driver de cola por defecto, puedes implementar la interfaz "),t("code",[a._v("ShouldBroadcastNow")]),a._v(" en lugar de "),t("code",[a._v("ShouldBroadcast")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token php language-php"}},[t("span",{pre:!0,attrs:{class:"token delimiter important"}},[a._v("<?php")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Contracts"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("ShouldBroadcastNow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ShippingStatusUpdated")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("implements")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ShouldBroadcastNow")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])])]),t("p",[t("a",{attrs:{name:"broadcast-conditions"}})]),a._v(" "),t("h3",{attrs:{id:"condiciones-de-la-transmision"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#condiciones-de-la-transmision"}},[a._v("#")]),a._v(" Condiciones de la transmisión")]),a._v(" "),t("p",[a._v("Algunas veces quieres transmitir tu evento sólo si una condición dada es verdadera. Puedes definir estas condiciones agregando un método "),t("code",[a._v("broadcastWhen")]),a._v(" a la clase de tu evento:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n* Determine if this event should broadcast.\n*\n* @return bool\n*/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcastWhen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$this")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("value")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"authorizing-channels"}})]),a._v(" "),t("h2",{attrs:{id:"autorizando-canales-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#autorizando-canales-2"}},[a._v("#")]),a._v(" Autorizando canales")]),a._v(" "),t("p",[a._v("Los canales privados requieren que autorizes que el usuario actualmente autenticado puede escuchar en el canal privado. Esto es logrado haciendo una solicitud HTTP a tu aplicación de Laravel con el nombre del canal y permitiendo a tu aplicación de terminar si el usuario puede escuchar en dicho canal. Al usar "),t("a",{attrs:{href:"#installing-laravel-echo"}},[a._v("Laravel Echo")]),a._v(", la solicitud HTTP para autorizar suscripciones a canales privados será realizada automáticamente; sin embargo, si necesitas definir las rutas necesarias para responder a estas solicitudes.")]),a._v(" "),t("p",[t("a",{attrs:{name:"defining-authorization-routes"}})]),a._v(" "),t("h3",{attrs:{id:"definiendo-rutas-de-autorizacion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#definiendo-rutas-de-autorizacion"}},[a._v("#")]),a._v(" Definiendo rutas de autorización")]),a._v(" "),t("p",[a._v("Afortunadamente, Laravel hace que sea fácil definir las rutas para responder a las solicitudes de autorización de canales. En el "),t("code",[a._v("BroadcastServiceProvider")]),a._v(" incluido con tu aplicación de Laravel, verás una llamada al método "),t("code",[a._v("Broadcast::routes")]),a._v(". Este método registrará la ruta "),t("code",[a._v("/broadcasting/auth")]),a._v(" para manejar las solicitudes de autorización:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("Broadcast"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("routes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("El método "),t("code",[a._v("Broadcast::routes")]),a._v(" automáticamente coloca sus rutas dentro del grupo de middleware "),t("code",[a._v("web")]),a._v("; sin embargo, puedes pasar un arreglo de atributos de ruta al método si te gustaría personalizar los atributos asignados:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("Broadcast"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("routes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$attributes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{attrs:{id:"personalizando-endpoints-de-autorizacion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#personalizando-endpoints-de-autorizacion"}},[a._v("#")]),a._v(" Personalizando endpoints de autorización")]),a._v(" "),t("p",[a._v("Por defecto, Echo usará el endpoint "),t("code",[a._v("/broadcasting/auth")]),a._v(" para autorizar acceso a canales. Sin embargo, puedes especificar tus propios endpoints de autorización pasando la opción de configuración "),t("code",[a._v("authEndpoint")]),a._v(" a tu instancia de Echo:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    broadcaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'pusher'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'your-pusher-channels-key'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    authEndpoint"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'/custom/endpoint/auth'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"defining-authorization-callbacks"}})]),a._v(" "),t("h3",{attrs:{id:"definiendo-callbacks-de-autorizacion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#definiendo-callbacks-de-autorizacion"}},[a._v("#")]),a._v(" Definiendo callbacks de autorización")]),a._v(" "),t("p",[a._v("Luego, necesitamos definir la lógica que realizará la autorización del canal. Esto es hecho en el archivo "),t("code",[a._v("routes/channels.php")]),a._v(" que es incluido con tu aplicación. En este archivo, puedes usar el método "),t("code",[a._v("Broadcast::channel")]),a._v(" para registrar callbacks de autorización de canales:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("Broadcast"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'order.{orderId}'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$orderId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("===")]),a._v(" Order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("findOrNew")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$orderId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("user_id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("El método "),t("code",[a._v("channel")]),a._v(" acepta dos argumentos: el nombre del canal y un callback que retorna "),t("code",[a._v("true")]),a._v(" o "),t("code",[a._v("false")]),a._v(" indicando si el usuario está autorizado para escuchar el canal.")]),a._v(" "),t("p",[a._v("Todos los callbacks de autorización reciben al usuario actualmente autenticado como primer argumento y cualquier parametro wildcard como sus argumentos siguientes. En este ejemplo, estamos usando el placeholder "),t("code",[a._v("{orderId}")]),a._v(' para indicar la porción "ID" del nombre del canal es un wildcard.')]),a._v(" "),t("h4",{attrs:{id:"enlace-de-modelos-del-callback-de-autorizacion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#enlace-de-modelos-del-callback-de-autorizacion"}},[a._v("#")]),a._v(" Enlace de modelos del callback de autorización")]),a._v(" "),t("p",[a._v("Igual que las rutas HTTP, las rutas de los canales pueden tomar ventaja de "),t("router-link",{attrs:{to:"/routing.html#route-model-binding"}},[a._v("modelo de enlace de rutas")]),a._v(" de forma implícita y explícita. Por ejemplo, en lugar de recibir la cadena o ID númerico de la orden, puedes solicitar una instancia del modelo "),t("code",[a._v("Order")]),a._v(":")],1),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Order")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nBroadcast"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'order.{order}'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" Order "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$order")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("===")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$order")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("user_id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{attrs:{id:"autenticacion-del-callback-de-autorizacion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#autenticacion-del-callback-de-autorizacion"}},[a._v("#")]),a._v(" Autenticación del callback de autorización")]),a._v(" "),t("p",[a._v("Los canales privados y de presencia autentican al usuario actual a través de la protección de autenticación por defecto de la aplicacion. Si el usuario no está autenticado, la autorizacion del canal es automáticamente negada y el callback de autorización nunca se ejecuta. Sin embargo, puedes asignar múltiples protecciones personalizadas que deben autenticar la solicitud entrante si es necesario:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("Broadcast"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'channel'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// ...")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'guards'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'web'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'admin'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"defining-channel-classes"}})]),a._v(" "),t("h3",{attrs:{id:"definiendo-clases-de-canales"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#definiendo-clases-de-canales"}},[a._v("#")]),a._v(" Definiendo clases de canales")]),a._v(" "),t("p",[a._v("Si tu aplicación está consumiendo muchos canales diferentes, tu archivo "),t("code",[a._v("routes/channels.php")]),a._v(" podría volverse voluminoso. Así que, en lugar de usar Closures para autorizar canales, puedes usar clases de canales. Para generar una clase de canal, usa el comando de artisan "),t("code",[a._v("make:channel")]),a._v(". Este comando colocará una nueva clase de canal en el directorio "),t("code",[a._v("App/Broadcasting")]),a._v(".")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("php artisan make"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("channel OrderChannel\n")])])]),t("p",[a._v("Luego, registra tu canal en tu archivo "),t("code",[a._v("routes/channels.php")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("OrderChannel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nBroadcast"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'order.{order}'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" OrderChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Finalmente, puedes colocar la lógica de autorización para tu canal en el método "),t("code",[a._v("join")]),a._v(" de la clase del canal. Este método "),t("code",[a._v("join")]),a._v(" contendrá la misma lógica que típicamente habrías colocado en el Closure de tu canal de autorización. Puedes también tomar ventaja del modelo de enlace de canales:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token php language-php"}},[t("span",{pre:!0,attrs:{class:"token delimiter important"}},[a._v("<?php")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("namespace")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Broadcasting")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Order")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("User")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("OrderChannel")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n    * Create a new channel instance.\n    *\n    * @return void\n    */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("__construct")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n    * Authenticate the user's access to the channel.\n    *\n    * @param  \\App\\User  $user\n    * @param  \\App\\Order  $order\n    * @return array|bool\n    */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("join")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("User "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" Order "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$order")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("===")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$order")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("user_id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("Como muchas otras clases en Laravel, las clases de canales automáticamente serán resueltas por el "),t("router-link",{attrs:{to:"/container.html"}},[a._v("contenedor de servicios")]),a._v(". Así que, puedes declarar el tipo de cualquier dependencia requerida por tu canal en su constructor.")],1)]),a._v(" "),t("p",[t("a",{attrs:{name:"broadcasting-events"}})]),a._v(" "),t("h2",{attrs:{id:"transmitiendo-eventos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#transmitiendo-eventos"}},[a._v("#")]),a._v(" Transmitiendo eventos")]),a._v(" "),t("p",[a._v("Una vez que has definido un evento y lo has marcado con la interfaz "),t("code",[a._v("ShouldBroadcast")]),a._v(", sólo necesitas ejecutar el evento usando la función "),t("code",[a._v("event")]),a._v(". El despachador de eventos notará que el evento está marcado con la interfaz "),t("code",[a._v("ShouldBroadcast")]),a._v(" y agrega el evento a la cola para transmisión:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("event")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ShippingStatusUpdated")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"only-to-others"}})]),a._v(" "),t("h3",{attrs:{id:"solo-a-otros"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solo-a-otros"}},[a._v("#")]),a._v(" Sólo a otros")]),a._v(" "),t("p",[a._v("Al construir una aplicación que usa la transmisión de eventos, puedes sustituir la función "),t("code",[a._v("event")]),a._v(" por la función "),t("code",[a._v("broadcast")]),a._v(". Como la función "),t("code",[a._v("event")]),a._v(", la función "),t("code",[a._v("broadcast")]),a._v(" despacha el evento a tus listeners del lado del servidor:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcast")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ShippingStatusUpdated")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Sin embargo, la función "),t("code",[a._v("broadcast")]),a._v(" también expone el método "),t("code",[a._v("toOthers")]),a._v(" que te permite excluir al usuario actual de los recipientes de la transmisión:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcast")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ShippingStatusUpdated")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("toOthers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Para entender mejor cuando es posible que quieras usar el método "),t("code",[a._v("toOthers")]),a._v(", vamos a imaginar una aplicación de lista de tareas donde un usuario puede crear una nueva tarea ingresando un nombre de tarea. Para crear una tarea, tu aplicación puede hacer una solicitud a un punto de salida "),t("code",[a._v("/task")]),a._v(" que transmite la creación de la tarea y retorna una representación JSON de la nueva tarea. Cuando tu aplicación de JavaScript recibe la respuesta del punto de salida, podría directamente insertar la nueva tarea en su lista de tareas de la siguiente forma:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("axios"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("post")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'/task'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" task"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("then")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        this"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("tasks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("push")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Sin embargo, recuerda que también transmitimos la creación de la tarea. Si tu aplicación de JavaScript está escuchando este evento para agregar tareas a la lista de tareas, tendrás tareas duplicadas en tu lista: una del punto de salida y una de la transmisión.  Puedes resolver esto usando el método "),t("code",[a._v("toOthers")]),a._v(" para instruir al transmisor para que no transmita el evento al usuario actual.")]),a._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[a._v("Nota")]),a._v(" "),t("p",[a._v("Tu evento debe usar el trait "),t("code",[a._v("Illuminate\\Broadcasting\\InteractsWithSockets")]),a._v(" para poder llamar al método "),t("code",[a._v("toOthers")]),a._v(".")])]),a._v(" "),t("h4",{attrs:{id:"configuracion-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configuracion-2"}},[a._v("#")]),a._v(" Configuración")]),a._v(" "),t("p",[a._v("Cuando incializas una instancia de Laravel Echo, un ID de socket es asignado a la conexión. Si estás usando "),t("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener noreferrer"}},[a._v("Vue"),t("OutboundLink")],1),a._v(" y "),t("a",{attrs:{href:"https://github.com/mzabriskie/axios",target:"_blank",rel:"noopener noreferrer"}},[a._v("Axios"),t("OutboundLink")],1),a._v(", el ID del socket será agregado automáticamente a cada solicitud saliente como un header "),t("code",[a._v("X-Socket-ID")]),a._v(". Entonces, cuando llamas al método "),t("code",[a._v("toOthers")]),a._v(", Laravel extraerá el ID del socket desde el encabezado e instruirá al transmisor a no transmitir a ninguna conexión con dicho ID de socket.")]),a._v(" "),t("p",[a._v("Si no estás usando Vue y Axios, necesitarás configurar manualmente tu aplicación de JavaScript para enviar el encabezado "),t("code",[a._v("X-Socket-ID")]),a._v(". Puedes retornar el ID del socket usando el método "),t("code",[a._v("Echo.socketId")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("var")]),a._v(" socketId "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("socketId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"receiving-broadcasts"}})]),a._v(" "),t("h2",{attrs:{id:"recibiendo-transmisiones"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#recibiendo-transmisiones"}},[a._v("#")]),a._v(" Recibiendo transmisiones")]),a._v(" "),t("p",[t("a",{attrs:{name:"installing-laravel-echo"}})]),a._v(" "),t("h3",{attrs:{id:"instalando-laravel-echo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#instalando-laravel-echo"}},[a._v("#")]),a._v(" Instalando laravel echo")]),a._v(" "),t("p",[a._v("Laravel Echo es una librería de JavaScript que hace que sea fácil suscribirse a canales y escuchar transmisiones de eventos en Laravel. Puedes instalar Echo mediante el administrador de paquetes NPM. En este ejemplo, también instalaremos el paquete "),t("code",[a._v("pusher-js")]),a._v(" dado que usaremos el transmisor de canales de Pusher:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("npm install "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("save laravel"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" pusher"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("js\n")])])]),t("p",[a._v("Una vez que Echo es instalado, estás listo para crear una instancia nueva de Echo en el JavaScript de tu aplicación. Un buen lugar para hacer esto es en la parte inferior del archivo "),t("code",[a._v("resources/js/bootstrap.js")]),a._v(" que es incluido con el framework Laravel:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("import "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" from "),t("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[a._v('"laravel-echo"')]),a._v("\n\nwindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    broadcaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'pusher'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'your-pusher-channels-key'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Al crear una instancia de Echo que usa el conector "),t("code",[a._v("pusher")]),a._v(", puedes especificar un "),t("code",[a._v("cluster")]),a._v(" así como si la conexión debería ser realizada mediante TLS (por defecto, cuando "),t("code",[a._v("forceTLS")]),a._v(" es "),t("code",[a._v("false")]),a._v(", una conexión no-TLS será realizada si la página fue cargada mediante HTTP, o como fallback si la conexión TLS falla):")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    broadcaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'pusher'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'your-pusher-channels-key'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'eu'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    forceTLS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean constant"}},[a._v("true")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{attrs:{id:"usando-una-instancia-de-cliente-existente"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#usando-una-instancia-de-cliente-existente"}},[a._v("#")]),a._v(" Usando una instancia de cliente existente")]),a._v(" "),t("p",[a._v("Si ya tienes una instancia de cliente de canales de Pusher o Socket.io que te gustaría que Echo usara, puedes pasarla a Echo mediante la opción de configuración "),t("code",[a._v("client")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("const")]),a._v(" client "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'pusher-js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nwindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    broadcaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'pusher'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'your-pusher-channels-key'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" client\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"listening-for-events"}})]),a._v(" "),t("h3",{attrs:{id:"escuchando-eventos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#escuchando-eventos"}},[a._v("#")]),a._v(" Escuchando eventos")]),a._v(" "),t("p",[a._v("Una vez que has instalado e instanciado Echo, estás listo para comenzar a escuchar transmisiones de eventos. Primero, usa el método "),t("code",[a._v("channel")]),a._v(" para retornar una instancia de un canal, luego llama al método "),t("code",[a._v("listen")]),a._v(" para escuchar a un evento especificado:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'orders'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'OrderShipped'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Si te gustaría escuchar eventos en un canal privado, usa el método "),t("code",[a._v("private")]),a._v(" en su lugar. Puedes continuar encadenando llamadas al método "),t("code",[a._v("listen")]),a._v(" para escuchar múltiples eventos en un sólo canal:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'orders'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"leaving-a-channel"}})]),a._v(" "),t("h3",{attrs:{id:"abandonando-un-canal"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#abandonando-un-canal"}},[a._v("#")]),a._v(" Abandonando un canal")]),a._v(" "),t("p",[a._v("Para abandonar un canal, puedes llamar al método "),t("code",[a._v("leaveChannel")]),a._v(" en tu instancia de Echo:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("leaveChannel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'orders'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Si te gustaría abandonar un canal y también sus canales privados y presenciales asociados, puedes usar el método "),t("code",[a._v("leave")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("leave")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'orders'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"namespaces"}})]),a._v(" "),t("h3",{attrs:{id:"nombres-de-espacio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nombres-de-espacio"}},[a._v("#")]),a._v(" Nombres de espacio")]),a._v(" "),t("p",[a._v("Puedes haber notado en los ejemplos superiores que no especificamos un nombre de espacio completo para las clases del evento. Esto es debido a que Echo automáticamente asumirá que los eventos están ubicados en el nombre de espacio "),t("code",[a._v("App\\Events")]),a._v(". Sin embargo, puedes configurar el nombre de espacio principal cuando instancias Echo pasando una opción de configuración "),t("code",[a._v("namespace")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    broadcaster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'pusher'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'your-pusher-channels-key'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'App.Other.Namespace'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Alternativamente, puedes prefijar las clases del evento con un "),t("code",[a._v(".")]),a._v(" al suscribrte a estos usando Echo. Esto te permitirá siempre especificar el nombre de clase completamente calificado:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'orders'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'.Namespace\\\\Event\\\\Class'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"presence-channels"}})]),a._v(" "),t("h2",{attrs:{id:"canales-de-presencia"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#canales-de-presencia"}},[a._v("#")]),a._v(" Canales de presencia")]),a._v(" "),t("p",[a._v("Los Canales de Presencia son construidos sobre la seguridad de los canales privados mientras que exponen la característica adicional de saber quien está susbscrito al canal. Esto hace que sea fácil construir características de aplicación poderosas y colaborativas como notificar a usuarios cuando otro usuario está viendo la misma página.")]),a._v(" "),t("p",[t("a",{attrs:{name:"authorizing-presence-channels"}})]),a._v(" "),t("h3",{attrs:{id:"autorizando-canales-de-presencia"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#autorizando-canales-de-presencia"}},[a._v("#")]),a._v(" Autorizando canales de presencia")]),a._v(" "),t("p",[a._v("Todos los canales de Presencia son también canales privados; por lo tanto, los usuarios deben estar "),t("a",{attrs:{href:"#authorizing-channels"}},[a._v("autorizados para accederlos")]),a._v(". Sin embargo, al definir callbacks de autorización para canales de presencia, no retornarás "),t("code",[a._v("true")]),a._v(" si el usuario está autorizado para unirse al canal. En su lugar, debes retornar un arreglo de datos sobre el usuario.")]),a._v(" "),t("p",[a._v("Los datos retornados por el callback de autorización estarán disponibles para los listeners de eventos de canales de presencia en tu aplicación de JavaScript. Si el usuario no está autorizado para unirse al canal de presencia, debes retornar "),t("code",[a._v("false")]),a._v(" o "),t("code",[a._v("null")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[a._v("Broadcast"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("channel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'chat.{roomId}'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$roomId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("canJoinRoom")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$roomId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'id'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'name'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"joining-presence-channels"}})]),a._v(" "),t("h3",{attrs:{id:"uniendose-a-canales-de-presencia"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#uniendose-a-canales-de-presencia"}},[a._v("#")]),a._v(" Uniendose a canales de presencia")]),a._v(" "),t("p",[a._v("Para unirse a un canal de presencia, puedes usar el método "),t("code",[a._v("join")]),a._v(" de Echo. El método "),t("code",[a._v("join")]),a._v(" retornará una implementación de "),t("code",[a._v("PresenceChannel")]),a._v(" que, junto con la exposición del método "),t("code",[a._v("listen")]),a._v(", te permite suscribirte a los eventos "),t("code",[a._v("here")]),a._v(", "),t("code",[a._v("joining")]),a._v(" y "),t("code",[a._v("leaving")]),a._v(".")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("join")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("`chat"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("roomId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("here")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("users"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("joining")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("leaving")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("El callback "),t("code",[a._v("here")]),a._v(" será ejecutado inmediatamente una vez que el canal se haya unido con éxito y recibirá un arreglo que contiene la información del usuario para todos los demás usuarios actualmente subscritos al canal. El método "),t("code",[a._v("joining")]),a._v(" será ejecutado cuando un nuevo usuario se une a un canal, mientras que el método "),t("code",[a._v("leaving")]),a._v(" será ejecutado cuando un usuario abandona el canal.")]),a._v(" "),t("p",[t("a",{attrs:{name:"broadcasting-to-presence-channels"}})]),a._v(" "),t("h3",{attrs:{id:"transmitiendo-a-canales-de-presencia"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#transmitiendo-a-canales-de-presencia"}},[a._v("#")]),a._v(" Transmitiendo a canales de presencia")]),a._v(" "),t("p",[a._v("Los canales de Presencia pueden recibir eventos igual que los canales públicos y privados. Usando el ejemplo de una sala de chat, podemos querer transmitir eventos "),t("code",[a._v("NewMessage")]),a._v(" al canal de presencia de la sala. Para hacer eso, retornaremos una instancia de "),t("code",[a._v("PresenceChannel")]),a._v(" desde el método "),t("code",[a._v("broadcastOn")]),a._v(" del evento:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n* Get the channels the event should broadcast on.\n*\n* @return Channel|array\n*/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcastOn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("PresenceChannel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'room.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$this")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("message")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("room_id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[a._v("Como los eventos públicos o privados, los canales de presencia pueden ser transmitidos usando la función "),t("code",[a._v("broadcast")]),a._v(". Como con otros eventos, puedes usar el método "),t("code",[a._v("toOthers")]),a._v(" para excluir al usuario actual de recibir las transmisiones:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcast")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("NewMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$message")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("broadcast")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("NewMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$message")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("toOthers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Puedes escuchar el evento join mediante el método "),t("code",[a._v("listen")]),a._v(" de Echo:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("join")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("`chat"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("roomId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("here")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("joining")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("leaving")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'NewMessage'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"client-events"}})]),a._v(" "),t("h2",{attrs:{id:"eventos-del-cliente"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#eventos-del-cliente"}},[a._v("#")]),a._v(" Eventos del cliente")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("Al usar "),t("a",{attrs:{href:"https://pusher.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("canales de Pusher"),t("OutboundLink")],1),a._v(', debes habilitar la opción "Client Events" en la sección "App Settings" del '),t("a",{attrs:{href:"https://dashboard.pusher.com/",target:"_blank",rel:"noopener noreferrer"}},[a._v("dashboard de tu aplicación"),t("OutboundLink")],1),a._v(" para enviar eventos del cliente.")])]),a._v(" "),t("p",[a._v('Algunas veces puedes querer transmitir un evento a otros clientes conectados sin tocar tu aplicación en lo absoluto. Esto puede ser particularmente útil para cosas como "escribir" notificaciones, donde quieres advertir a los usuarios de tu aplicación que otro usuario está escribiendo un mensaje en una pantalla dada.')]),a._v(" "),t("p",[a._v("Para transmitir eventos del cliente, puedes usar el método "),t("code",[a._v("whisper")]),a._v(" de Echo:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'chat'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("whisper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'typing'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" this"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("name\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Para escuchar eventos del cliente, puedes usar el método "),t("code",[a._v("listenForWhisper")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'chat'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listenForWhisper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'typing'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{attrs:{name:"notifications"}})]),a._v(" "),t("h2",{attrs:{id:"notificaciones"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#notificaciones"}},[a._v("#")]),a._v(" Notificaciones")]),a._v(" "),t("p",[a._v("Al juntar transmisión de eventos con "),t("router-link",{attrs:{to:"/notifications.html"}},[a._v("notificaciones")]),a._v(", tu aplicación de JavaScript puede recibir nuevas notificaciones mientras ocurren sin necesidad de refrescar la página. Primero, asegurate de leer la documentación sobre el uso "),t("router-link",{attrs:{to:"/notifications.html#broadcast-notifications"}},[a._v("del canal de transmisión de notificaciones")]),a._v(".")],1),a._v(" "),t("p",[a._v("Una vez que has configurado una notificación para usar el canal de transmisión, puedes escuchar a los eventos de la transmisión usando el método "),t("code",[a._v("notification")]),a._v(" de Echo. Recuerda, el nombre del canal debe ser igual al nombre de la clase de la entidad recibiendo la notificaciones:")]),a._v(" "),t("div",{staticClass:"language-php extra-class"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Echo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("`App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("userId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("notification")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("notification"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("notification"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("En este ejemplo, todas las notificaciones enviadas a instancias de "),t("code",[a._v("App\\User")]),a._v(" mediante el canal "),t("code",[a._v("broadcast")]),a._v(" serán recibidas por el callback. Un callback de autorización de canal para el canal "),t("code",[a._v("App.User.{id}")]),a._v(" es incluido en el "),t("code",[a._v("BroadcastServiceProvider")]),a._v(" que viene con el framework Laravel por defecto.")])])}),[],!1,null,null,null);s.default=n.exports}}]);