<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VuePress</title>
    <meta name="generator" content="VuePress 1.8.1">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.f7a12d87.css" as="style"><link rel="preload" href="/assets/js/app.e3311cd2.js" as="script"><link rel="preload" href="/assets/js/2.648c6578.js" as="script"><link rel="preload" href="/assets/js/70.e66fe735.js" as="script"><link rel="prefetch" href="/assets/js/10.f234decd.js"><link rel="prefetch" href="/assets/js/11.f0ca56a6.js"><link rel="prefetch" href="/assets/js/12.5865c9a5.js"><link rel="prefetch" href="/assets/js/13.8e509b37.js"><link rel="prefetch" href="/assets/js/14.2d9f5c97.js"><link rel="prefetch" href="/assets/js/15.b917edb6.js"><link rel="prefetch" href="/assets/js/16.a13d2a39.js"><link rel="prefetch" href="/assets/js/17.d6b71ec0.js"><link rel="prefetch" href="/assets/js/18.adbe50b4.js"><link rel="prefetch" href="/assets/js/19.a1638529.js"><link rel="prefetch" href="/assets/js/20.393f35ab.js"><link rel="prefetch" href="/assets/js/21.a9dd9148.js"><link rel="prefetch" href="/assets/js/22.087385e4.js"><link rel="prefetch" href="/assets/js/23.b6ce1d9c.js"><link rel="prefetch" href="/assets/js/24.a74b28c6.js"><link rel="prefetch" href="/assets/js/25.7a984c35.js"><link rel="prefetch" href="/assets/js/26.cf45c453.js"><link rel="prefetch" href="/assets/js/27.e36a56dc.js"><link rel="prefetch" href="/assets/js/28.358fc226.js"><link rel="prefetch" href="/assets/js/29.f4fd2139.js"><link rel="prefetch" href="/assets/js/3.40d230a8.js"><link rel="prefetch" href="/assets/js/30.564d0795.js"><link rel="prefetch" href="/assets/js/31.0691b4c8.js"><link rel="prefetch" href="/assets/js/32.088de00e.js"><link rel="prefetch" href="/assets/js/33.4d884bb7.js"><link rel="prefetch" href="/assets/js/34.c4be32cd.js"><link rel="prefetch" href="/assets/js/35.b78c77b2.js"><link rel="prefetch" href="/assets/js/36.ceed3144.js"><link rel="prefetch" href="/assets/js/37.f9d6aca2.js"><link rel="prefetch" href="/assets/js/38.67ad3e03.js"><link rel="prefetch" href="/assets/js/39.5e3e70a7.js"><link rel="prefetch" href="/assets/js/4.e81ef12f.js"><link rel="prefetch" href="/assets/js/40.0510efa5.js"><link rel="prefetch" href="/assets/js/41.4e2bcf98.js"><link rel="prefetch" href="/assets/js/42.ebc7d9c8.js"><link rel="prefetch" href="/assets/js/43.e5970289.js"><link rel="prefetch" href="/assets/js/44.f91a9970.js"><link rel="prefetch" href="/assets/js/45.603b4584.js"><link rel="prefetch" href="/assets/js/46.037dce36.js"><link rel="prefetch" href="/assets/js/47.fadd0db4.js"><link rel="prefetch" href="/assets/js/48.457d9287.js"><link rel="prefetch" href="/assets/js/49.da492613.js"><link rel="prefetch" href="/assets/js/5.dc790133.js"><link rel="prefetch" href="/assets/js/50.cab6e13d.js"><link rel="prefetch" href="/assets/js/51.0765def4.js"><link rel="prefetch" href="/assets/js/52.518165a7.js"><link rel="prefetch" href="/assets/js/53.1e887b4a.js"><link rel="prefetch" href="/assets/js/54.bc10b491.js"><link rel="prefetch" href="/assets/js/55.2e54a7e8.js"><link rel="prefetch" href="/assets/js/56.169c81e5.js"><link rel="prefetch" href="/assets/js/57.a4ef4ed1.js"><link rel="prefetch" href="/assets/js/58.78dc0897.js"><link rel="prefetch" href="/assets/js/59.f13515c7.js"><link rel="prefetch" href="/assets/js/6.de2c94ff.js"><link rel="prefetch" href="/assets/js/60.ebfdeb63.js"><link rel="prefetch" href="/assets/js/61.6523e015.js"><link rel="prefetch" href="/assets/js/62.cb19c9bd.js"><link rel="prefetch" href="/assets/js/63.6ae10337.js"><link rel="prefetch" href="/assets/js/64.50298a81.js"><link rel="prefetch" href="/assets/js/65.d1849c5b.js"><link rel="prefetch" href="/assets/js/66.caef6860.js"><link rel="prefetch" href="/assets/js/67.a2788988.js"><link rel="prefetch" href="/assets/js/68.1c43eae0.js"><link rel="prefetch" href="/assets/js/69.e16965c5.js"><link rel="prefetch" href="/assets/js/7.0466c7e3.js"><link rel="prefetch" href="/assets/js/71.6d49148f.js"><link rel="prefetch" href="/assets/js/72.c3d54f60.js"><link rel="prefetch" href="/assets/js/73.125d4466.js"><link rel="prefetch" href="/assets/js/74.f1ed7f47.js"><link rel="prefetch" href="/assets/js/75.2f92d842.js"><link rel="prefetch" href="/assets/js/76.634dc6b8.js"><link rel="prefetch" href="/assets/js/77.db030077.js"><link rel="prefetch" href="/assets/js/78.ef9b3a22.js"><link rel="prefetch" href="/assets/js/79.a9b05b84.js"><link rel="prefetch" href="/assets/js/8.0435cf5c.js"><link rel="prefetch" href="/assets/js/80.88069fe6.js"><link rel="prefetch" href="/assets/js/9.d31992a0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f7a12d87.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><div><h1 id="sesion-http"><a class="header-anchor" href="#sesion-http">#</a> Sesión HTTP</h1> <ul><li><a href="#introduction">Introducción</a> <ul><li><a href="#configuration">Configuración</a></li> <li><a href="#driver-prerequisites">Prerequisitos de manejador</a></li></ul></li> <li><a href="#using-the-session">Usando la sesión</a> <ul><li><a href="#retrieving-data">Obteniendo datos</a></li> <li><a href="#storing-data">Almacenando datos</a></li> <li><a href="#flash-data">Datos instantáneos</a></li> <li><a href="#deleting-data">Eliminando datos</a></li> <li><a href="#regenerating-the-session-id">Regenerando el ID de la sesión</a></li></ul></li> <li><a href="#adding-custom-session-drivers">Agregando manejadores de sesión personalizada</a> <ul><li><a href="#implementing-the-driver">Implementando el manejador</a></li> <li><a href="#registering-the-driver">Registrando el manejador</a></li></ul></li></ul> <p><a name="introduction"></a></p> <h2 id="introduccion"><a class="header-anchor" href="#introduccion">#</a> Introducción</h2> <p>Ya que las aplicaciones manejadas por HTTP son sin estado, las sesiones proporcionan una forma de almacenar información sobre el usuario a través de múltiples solicitudes. Laravel viene con una variedad de backends de sesión que son accedidos a través de una expresiva API unificada. El soporte para los backends populares tales como <a href="https://memcached.org" target="_blank" rel="noopener noreferrer">Memcached<OutboundLink></OutboundLink></a>, <a href="https://redis.io" target="_blank" rel="noopener noreferrer">Redis<OutboundLink></OutboundLink></a> y bases de datos es incluido de forma predeterminada.</p> <p><a name="configuration"></a></p> <h3 id="configuracion"><a class="header-anchor" href="#configuracion">#</a> Configuración</h3> <p>El archivo de configuración de sesión es almacenado en <code>config/session.php</code>. Asegúrate de revisar las opciones disponibles para ti en este archivo. De forma predeterminada, Laravel está configurado para usar el manejador de sesión <code>file</code>, el cual trabajará bien con muchas aplicaciones.</p> <p>La opción de configuración <code>driver</code> de la sesión define donde los datos de la sesión serán almacenados para cada solicitud. Laravel viene con varios manejadores excelentes de forma predeterminada.</p> <ul><li><code>file</code> - las sesiones son almacenadas en <code>storage/framework/sessions</code>.</li> <li><code>cookie</code> - las sesiones son almacenadas en cookies encriptados y seguros.</li> <li><code>database</code> - las sesiones son almacenadas en una base de datos relacional.</li> <li><code>memcached</code> / <code>redis</code> - las sesiones son almacenadas en rápidos almacenes basados en cache.</li> <li><code>array</code> - las sesiones son almacenadas en un arreglo de PHP y no serán guardadas de forma permanente.</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>El driver array es usado durante <RouterLink to="/testing.html">las pruebas</RouterLink> y previene que los datos almacenados en la sesión sean guardados de forma permanente.</p></div></div><p><a name="driver-prerequisites"></a></p> <h3 id="prerequisitos-del-driver"><a href="#prerequisitos-del-driver" class="header-anchor">#</a> Prerequisitos del driver</h3> <h4 id="base-de-datos"><a href="#base-de-datos" class="header-anchor">#</a> Base de datos</h4> <p>Al momento de usar el driver de sesión <code>database</code>, necesitarás crear una tabla para contener los elementos de la sesión. A continuación se muestra una declaración de <code>Schema</code> de ejemplo para la tabla:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'sessions'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">unsignedInteger</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'user_id'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ip_address'</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'user_agent'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'last_activity'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Puedes usar el comando Artisan <code>session:table</code> para generar esta migración:</p> <div class="language-php extra-class"><pre class="language-php"><code>php artisan <span class="token argument-name">session</span><span class="token punctuation">:</span>table

php artisan migrate
</code></pre></div><h4 id="redis"><a href="#redis" class="header-anchor">#</a> Redis</h4> <p>Antes de usar sesiones de Redis con Laravel, necesitarás instalar ya sea la extensión PhpRedis de PHP mediante PECL o instalar el paquete <code>predis/predis</code> (~1.0) mediante Composer. Para más información sobre cómo configurar Redis, <a href="/redis.html#configuration">consulta su página en la documentación</a>.</p> <div class="custom-block danger"><p class="custom-block-title">Tip</p> <p>En el archivo de configuración <code>session</code>, la opción <code>connection</code> puede ser usada para especificar qué conexión de Redis es utilizada por la sesión.</p></div> <p><a name="using-the-session"></a></p> <h2 id="usando-la-sesion"><a href="#usando-la-sesion" class="header-anchor">#</a> Usando la sesión</h2> <p><a name="retrieving-data"></a></p> <h3 id="obteniendo-datos"><a href="#obteniendo-datos" class="header-anchor">#</a> Obteniendo datos</h3> <p>Hay dos formas principales de trabajar con datos de sesión en Laravel: el helper global <code>session</code> y por medio de una instancia <code>Request</code>. Primero, vamos a dar un vistazo al acceder a la sesión por medio de una instancia <code>Request</code>, la cual puede ser referenciada en un método de controlador. Recuerda, las dependencias de métodos de controlador son inyectadas automáticamente por medio del <a href="/container.html">contenedor de servicio</a> de Laravel:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Show the profile for the given user.
    *
    * @param  Request  $request
    * @param  int  $id
    * @return Response
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Cuando obtienes un elemento de la sesión, también puedes pasar un valor predeterminado como segundo argumento del método <code>get</code>. Este valor predeterminado será devuelto si la clave especificada no existe en la sesión. Si pasas una <code>Closure</code> como el valor predeterminado del método <code>get</code> y la clave solicitada no existe, la <code>Closure</code> será ejecutada y su resultado devuelto:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string single-quoted-string">'default'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="helper-global-de-sesion"><a href="#helper-global-de-sesion" class="header-anchor">#</a> Helper global de sesión</h4> <p>También puedes usar la función global de PHP <code>session</code> para obtener y almacenar datos en la sesión. Cuando el helper <code>session</code> es ejecutado con un solo argumento de cadena, devolverá el valor de esa clave de sesión. Cuando el helper es ejecutado con una arreglo de pares clave / valor, esos valores serán almacenados en la sesión:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'home'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Retrieve a piece of data from the session...</span>
    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">session</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Specifying a default value...</span>
    <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">session</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Store a piece of data in the session...</span>
    <span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Hay una pequeña diferencia práctica entre usar la sesión por medio de una instancia de solicitud HTTP contra usar el helper global <code>session</code>. Ambos métodos pueden ser <a href="/testing.html">probados</a> por medio del método <code>assertSessionHas</code>, el cual está disponible en todos tus casos de prueba.</p></div> <h4 id="obteniendo-todos-los-datos-de-sesion"><a href="#obteniendo-todos-los-datos-de-sesion" class="header-anchor">#</a> Obteniendo todos los datos de sesión</h4> <p>Si prefieres obtener todos los datos en la sesión, puedes usar el método <code>all</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="determinando-si-un-elemento-existe-en-la-sesion"><a href="#determinando-si-un-elemento-existe-en-la-sesion" class="header-anchor">#</a> Determinando si un elemento existe en la sesión</h4> <p>Para determinar si un elemento está presente en la sesión, puedes usar el método <code>has</code>. El método <code>has</code> devuelve <code>true</code> si el valor está presente y no es <code>null</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Para determinar si un elemento está presente en la sesión, incluso si su valor es <code>null</code>, puedes usar el método <code>exists</code>. El método <code>exists</code> devuelve <code>true</code> si el valor está presente:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="storing-data"></a></p> <h3 id="almacenando-datos"><a href="#almacenando-datos" class="header-anchor">#</a> Almacenando datos</h3> <p>Para almacenar datos en la sesión, típicamente usarás el método <code>put</code> o el helper <code>session</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// Via a request instance...</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Via the global helper...</span>
<span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="agregar-a-valores-del-arreglo-de-sesion"><a href="#agregar-a-valores-del-arreglo-de-sesion" class="header-anchor">#</a> Agregar a valores del arreglo de sesión</h4> <p>El método <code>push</code> puede ser usado para agregar un nuevo valor a un valor de sesión que está en un arreglo. Por ejemplo, si la clave <code>user.teams</code> contiene un arreglo de nombres de equipo, puedes agregar un nuevo valor al arreglo de la siguiente forma:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'user.teams'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'developers'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="obteniendo-y-eliminando-un-elemento"><a href="#obteniendo-y-eliminando-un-elemento" class="header-anchor">#</a> Obteniendo y eliminando un elemento</h4> <p>El método <code>pull</code> obtendrá y eliminará un elemento de la sesión en una sola instrucción:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">pull</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="flash-data"></a></p> <h3 id="datos-instantaneos"><a href="#datos-instantaneos" class="header-anchor">#</a> Datos instantáneos</h3> <p>Algunas veces puedes querer almacenar varios elementos en la sesión para la próxima solicitud. Puedes hacer eso usando el método <code>flash</code>. Los datos almacenados en la sesión usando este método estarán disponibles de forma inmediata así como también en la solicitud HTTP posterior. Luego de la petición HTTP posterior, los datos instantáneos serán eliminados. Los datos instantáneos son principalmente útiles para mensajes de estado con vida corta:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">flash</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'status'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Task was successful!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si necesitas mantener tus datos instantáneos durante varias solicitudes, puedes usar el método <code>reflash</code>, el cuál mantendrá todos los datos instantáneos para una solicitud adicional. Si solamente necesitas mantener datos instantáneos específicos, puedes usar el método <code>keep</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">reflash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">keep</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="deleting-data"></a></p> <h3 id="eliminando-datos"><a href="#eliminando-datos" class="header-anchor">#</a> Eliminando datos</h3> <p>El método <code>forget</code> removerá una porción de datos de la sesión. Si prefieres remover todos los datos de la sesión, puedes usar el método <code>flush</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// Forget a single key...</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">forget</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Forget multiple keys...</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">forget</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="regenerating-the-session-id"></a></p> <h3 id="regenerando-el-id-de-la-sesion"><a href="#regenerando-el-id-de-la-sesion" class="header-anchor">#</a> Regenerando el ID de la sesión</h3> <p>La regeneración del ID de la sesión se realiza frecuentemente con el propósito de prevenir que usuarios maliciosos exploten un ataque de <a href="https://en.wikipedia.org/wiki/Session_fixation" target="_blank" rel="noopener noreferrer">fijación de sesión<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> en tu aplicación.</p> <p>Laravel regenera automáticamente el ID de la sesión durante la autenticación si estás usando el <code>LoginController</code> integrado; sin embargo, si necesitas regenerar manualmente el ID de la sesión, puedes usar el método <code>regenerate</code>.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">regenerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="adding-custom-session-drivers"></a></p> <h2 id="agregando-manejadores-de-sesion-personalizados"><a href="#agregando-manejadores-de-sesion-personalizados" class="header-anchor">#</a> Agregando manejadores de sesión personalizados</h2> <p><a name="implementing-the-driver"></a></p> <h4 id="implementando-el-manejador"><a href="#implementando-el-manejador" class="header-anchor">#</a> Implementando el manejador</h4> <p>Tu manejador de sesión personalizado debería implementar la interfaz <code>SessionHandlerInterface</code>. Esta interfaz contiene justo unos cuantos métodos que necesitamos implementar. Una implementación MongoDB truncada luce de forma similar a lo siguiente:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Extensions</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MongoSessionHandler</span> <span class="token keyword">implements</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>SessionHandlerInterface</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token variable">$savePath</span><span class="token punctuation">,</span> <span class="token variable">$sessionName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token variable">$sessionId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$sessionId</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token variable">$sessionId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">gc</span><span class="token punctuation">(</span><span class="token variable">$lifetime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Laravel no viene con un directorio para contener tus extensiones. Eres libre de colocarlos en cualquier parte que quieras. En este ejemplo, hemos creado un directorio <code>Extensions</code> para alojar el manejador <code>MongoSessionHandler</code>.</p></div> <p>Ya que el propósito de estos métodos no es entendible rápidamente y sin dificultad, vamos a cubrir rápidamente lo que cada uno de estos métodos hace:</p> <ul><li>El método <code>open</code> típicamente sería usado en sistemas de almacenamiento de sesión basada en archivo. Ya que Laravel viene con un manejador de sesión <code>file</code>, casi nunca necesitarás poner cualquier cosa en este método. Puedes dejarlo como un stub vacío. Es una característica de diseño de interfaz pobre (lo que discutiremos más tarde) que PHP nos oblige a implementar este método.</li> <li>El método <code>close</code>, como el método <code>open</code>, también puede ser descartado. Para la mayoría de los drivers, no es necesario.</li> <li>El método <code>read</code> debería devolver la versión de cadena de la sesión de datos asociada con la <code>$sessionId</code> dada. No hay necesidad de hacer alguna serialización u otra codificación al momento de obtener o almacenar los datos de la sesión en tu manejador, ya que Laravel ejecutará la serialización por ti.</li> <li>El método <code>write</code> debería escribir la cadena <code>$data</code> asociada dada con la <code>$sessionId</code> para algún sistema de almacenamiento persistente, tal como MongoDB, Dynamo, etc. Otra vez, no deberías ejecutar alguna serialización - Laravel ya ha manejado esto por ti.</li> <li>El método <code>destroy</code> debería remover los datos asociados con la <code>$sessionId</code> desde el almacenamiento persistente.</li> <li>El método <code>gc</code> debería destruir todos los datos de la sesión que son más viejos que el <code>$lifetime</code> dado, el cual es una marca de tiempo UNIX. Para los sistemas que se auto-expiran como Memcached y Redis, este método puede ser dejado vacío.</li></ul> <p><a name="registering-the-driver"></a></p> <h4 id="registrando-el-manejador"><a href="#registrando-el-manejador" class="header-anchor">#</a> Registrando el manejador</h4> <p>Una vez que tu manejador ha sido implementado, estás listo para registrarlo en el framework. Para agregar manejadores adicionales para el backend de sesión de Laravel, puedes usar el método <code>extend</code> del <a href="/facades.html">facade</a> <code>Session</code>. Deberías ejecutar el método <code>extend</code> desde el método <code>boot</code> de un <a href="/providers.html">proveedor de servicio</a>. Puedes hacer esto desde el <code>AppServiceProvider</code> existente o crear un nuevo proveedor de servicios completo:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Providers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Extensions<span class="token punctuation">\</span>MongoSessionHandler</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Session</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>ServiceProvider</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">SessionServiceProvider</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceProvider</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Register any application services.
    *
    * @return void
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * Bootstrap any application services.
    *
    * @return void
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name static-context">Session</span><span class="token operator">::</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'mongo'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Return implementation of SessionHandlerInterface...</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MongoSessionHandler</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Una vez que el manejador de la sesión ha sido registrado, puedes usar el manejador <code>mongo</code> en tu archivo de configuración <code>config/session.php</code>.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e3311cd2.js" defer></script><script src="/assets/js/2.648c6578.js" defer></script><script src="/assets/js/70.e66fe735.js" defer></script>
  </body>
</html>
