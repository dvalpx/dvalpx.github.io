<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Documentación de Laravel</title>
    <meta name="description" content="Documentación de Laravel en Español">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Catamaran:300,700|Miriam+Libre">
  <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.1d810b70.css" as="style"><link rel="preload" href="/assets/js/app.2b9ea969.js" as="script"><link rel="preload" href="/assets/js/2.8f57d70e.js" as="script"><link rel="preload" href="/assets/js/67.2883abee.js" as="script"><link rel="prefetch" href="/assets/js/10.7938642f.js"><link rel="prefetch" href="/assets/js/11.c6b40999.js"><link rel="prefetch" href="/assets/js/12.f18cbc71.js"><link rel="prefetch" href="/assets/js/13.87062664.js"><link rel="prefetch" href="/assets/js/14.716cc2f2.js"><link rel="prefetch" href="/assets/js/15.101f24d3.js"><link rel="prefetch" href="/assets/js/16.194f71f1.js"><link rel="prefetch" href="/assets/js/17.7a326a09.js"><link rel="prefetch" href="/assets/js/18.b64057ad.js"><link rel="prefetch" href="/assets/js/19.fd9838bd.js"><link rel="prefetch" href="/assets/js/20.a746ec9b.js"><link rel="prefetch" href="/assets/js/21.0b1db6c3.js"><link rel="prefetch" href="/assets/js/22.53339c00.js"><link rel="prefetch" href="/assets/js/23.6b0cb45c.js"><link rel="prefetch" href="/assets/js/24.93c8a909.js"><link rel="prefetch" href="/assets/js/25.117b3835.js"><link rel="prefetch" href="/assets/js/26.69cc1975.js"><link rel="prefetch" href="/assets/js/27.7c03833d.js"><link rel="prefetch" href="/assets/js/28.d8cd7c15.js"><link rel="prefetch" href="/assets/js/29.3c433a6b.js"><link rel="prefetch" href="/assets/js/3.37d22ff0.js"><link rel="prefetch" href="/assets/js/30.51df909b.js"><link rel="prefetch" href="/assets/js/31.3e424427.js"><link rel="prefetch" href="/assets/js/32.723aca49.js"><link rel="prefetch" href="/assets/js/33.baa640d1.js"><link rel="prefetch" href="/assets/js/34.df138466.js"><link rel="prefetch" href="/assets/js/35.21e17f02.js"><link rel="prefetch" href="/assets/js/36.2e171db2.js"><link rel="prefetch" href="/assets/js/37.bec18e54.js"><link rel="prefetch" href="/assets/js/38.a7a776ca.js"><link rel="prefetch" href="/assets/js/39.b9a4f2fb.js"><link rel="prefetch" href="/assets/js/4.95b68b43.js"><link rel="prefetch" href="/assets/js/40.2246938f.js"><link rel="prefetch" href="/assets/js/41.22ea0021.js"><link rel="prefetch" href="/assets/js/42.5ad9fa0f.js"><link rel="prefetch" href="/assets/js/43.b047d897.js"><link rel="prefetch" href="/assets/js/44.5768076f.js"><link rel="prefetch" href="/assets/js/45.bace0817.js"><link rel="prefetch" href="/assets/js/46.64b5b83e.js"><link rel="prefetch" href="/assets/js/47.db1a199f.js"><link rel="prefetch" href="/assets/js/48.64f86db5.js"><link rel="prefetch" href="/assets/js/49.869a49e7.js"><link rel="prefetch" href="/assets/js/5.f56202c2.js"><link rel="prefetch" href="/assets/js/50.4c133fa7.js"><link rel="prefetch" href="/assets/js/51.b6f5c408.js"><link rel="prefetch" href="/assets/js/52.c31b3720.js"><link rel="prefetch" href="/assets/js/53.c516dc0d.js"><link rel="prefetch" href="/assets/js/54.0a75eebd.js"><link rel="prefetch" href="/assets/js/55.b4187092.js"><link rel="prefetch" href="/assets/js/56.fd9cd33d.js"><link rel="prefetch" href="/assets/js/57.af8c7f72.js"><link rel="prefetch" href="/assets/js/58.74f43cd5.js"><link rel="prefetch" href="/assets/js/59.33be1234.js"><link rel="prefetch" href="/assets/js/6.7ed940c0.js"><link rel="prefetch" href="/assets/js/60.ca4183e4.js"><link rel="prefetch" href="/assets/js/61.f8caddf4.js"><link rel="prefetch" href="/assets/js/62.c2681bcb.js"><link rel="prefetch" href="/assets/js/63.0febbdbe.js"><link rel="prefetch" href="/assets/js/64.aa808f04.js"><link rel="prefetch" href="/assets/js/65.faf253ca.js"><link rel="prefetch" href="/assets/js/66.f6fff51f.js"><link rel="prefetch" href="/assets/js/68.54d7ea98.js"><link rel="prefetch" href="/assets/js/69.836842cc.js"><link rel="prefetch" href="/assets/js/7.24ef9c67.js"><link rel="prefetch" href="/assets/js/70.ddbff7ae.js"><link rel="prefetch" href="/assets/js/71.e740d466.js"><link rel="prefetch" href="/assets/js/72.cd2c768b.js"><link rel="prefetch" href="/assets/js/73.e5ae99e8.js"><link rel="prefetch" href="/assets/js/74.940c12d4.js"><link rel="prefetch" href="/assets/js/75.959ec3b1.js"><link rel="prefetch" href="/assets/js/76.aa5495f9.js"><link rel="prefetch" href="/assets/js/77.5805f9d3.js"><link rel="prefetch" href="/assets/js/78.b9cb1e95.js"><link rel="prefetch" href="/assets/js/79.8f864857.js"><link rel="prefetch" href="/assets/js/8.c7de5777.js"><link rel="prefetch" href="/assets/js/80.74130e6a.js"><link rel="prefetch" href="/assets/js/81.d2036601.js"><link rel="prefetch" href="/assets/js/82.87cc02ef.js"><link rel="prefetch" href="/assets/js/83.569392ab.js"><link rel="prefetch" href="/assets/js/84.f690ba1e.js"><link rel="prefetch" href="/assets/js/85.dca0f9e9.js"><link rel="prefetch" href="/assets/js/9.52de0ad8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1d810b70.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Documentación de Laravel</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Inicio</a></div><div class="nav-item"><a href="/glossary.html" class="nav-link">Glosario</a></div><div class="nav-item"><a href="/credits.html" class="nav-link">Créditos</a></div><div class="nav-item"><a href="https://styde.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Styde
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Inicio</a></div><div class="nav-item"><a href="/glossary.html" class="nav-link">Glosario</a></div><div class="nav-item"><a href="/credits.html" class="nav-link">Créditos</a></div><div class="nav-item"><a href="https://styde.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Styde
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Primeros pasos</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Conceptos de arquitectura</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Fundamentos</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Frontend</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Seguridad</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Profundizando</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Bases de datos</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/database.html" class="sidebar-link">/database.html</a></li><li><a href="/queries.html" class="sidebar-link">/queries.html</a></li><li><a href="/pagination.html" class="sidebar-link">/pagination.html</a></li><li><a href="/migrations.html" class="sidebar-link">/migrations.html</a></li><li><a href="/seeding.html" class="sidebar-link">/seeding.html</a></li><li><a href="/redis.html" class="active sidebar-link">/redis.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/redis.html#introduccion" class="sidebar-link">Introducción</a></li><li class="sidebar-sub-header"><a href="/redis.html#interactuar-con-redis" class="sidebar-link">Interactuar con redis</a></li><li class="sidebar-sub-header"><a href="/redis.html#pub-sub" class="sidebar-link">Pub / Sub</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ORM Eloquent</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Pruebas</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Paquetes oficiales</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div><h1 id="redis"><a class="header-anchor" href="#redis" aria-hidden="true">#</a> Redis</h1> <ul><li><a href="#introduction">Introducción</a> <ul><li><a href="#configuration">Configuración</a></li> <li><a href="#predis">Predis</a></li> <li><a href="#phpredis">PhpRedis</a></li></ul></li> <li><a href="#interacting-with-redis">Interactuar con redis</a> <ul><li><a href="#pipelining-commands">Canalizar comandos</a></li></ul></li> <li><a href="#pubsub">Pub / Sub</a></li></ul> <p><a name="introduction"></a></p> <h2 id="introduccion"><a class="header-anchor" href="#introduccion" aria-hidden="true">#</a> Introducción</h2> <p><a href="https://redis.io" target="_blank" rel="noopener noreferrer">Redis<OutboundLink></OutboundLink></a> es un almacenamiento avanzado de pares clave-valor y de código abierto. A menudo se le denomina como un servidor de estructura de datos ya que los pares pueden contener <a href="https://redis.io/topics/data-types#strings" target="_blank" rel="noopener noreferrer">cadenas<OutboundLink></OutboundLink></a>, <a href="https://redis.io/topics/data-types#hashes" target="_blank" rel="noopener noreferrer">hashes<OutboundLink></OutboundLink></a>, <a href="https://redis.io/topics/data-types#lists" target="_blank" rel="noopener noreferrer">listas<OutboundLink></OutboundLink></a>, <a href="https://redis.io/topics/data-types#sets" target="_blank" rel="noopener noreferrer">sets<OutboundLink></OutboundLink></a> y <a href="https://redis.io/topics/data-types#sorted-sets" target="_blank" rel="noopener noreferrer">sets ordenados<OutboundLink></OutboundLink></a>.</p> <p>Antes de utilizar Redis con Laravel, deberás instalar el paquete <code>predis/predis</code> por medio de Composer:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code>composer <span class="token keyword">require</span> predis<span class="token operator">/</span>predis
</code></pre></div><p>Alternativamente, puedes instalar la extensión de PHP <a href="https://github.com/phpredis/phpredis" target="_blank" rel="noopener noreferrer">PhpRedis<OutboundLink></OutboundLink></a> por medio de PECL. La extensión puede ser más compleja de instalar pero puede ofrecer un mejor rendimiento para las aplicaciones que hacen uso extensivo de Redis.</p> <p><a name="configuration"></a></p> <h3 id="configuracion"><a class="header-anchor" href="#configuracion" aria-hidden="true">#</a> Configuración</h3> <p>La configuración de redis para tu aplicación está ubicada en el archivo de cofiguración <code>config/database</code>. Dentro de este archivo, podrás ver el arreglo <code>redis</code> que contiene los servidores de Redis utilizados por tu aplicación:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token single-quoted-string string">'redis'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>

    <span class="token single-quoted-string string">'client'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'predis'</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'default'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'host'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_HOST'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PASSWORD'</span><span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'port'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PORT'</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'database'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_DB'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'cache'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'host'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_HOST'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PASSWORD'</span><span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'port'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PORT'</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'database'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_CACHE_DB'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>La configuración del servidor por defecto deberá ser suficiente para el entorno de desarrollo. Sin embargo, puedes modificar este arreglo según tu entorno. Cada servidor de Redis definido en tu configuración debe contener un nombre, host y puerto.</p> <h4 id="configuracion-de-clusters"><a class="header-anchor" href="#configuracion-de-clusters" aria-hidden="true">#</a> Configuración de clusters</h4> <p>Si tu aplicación está utilizando un cluster de servidores Redis, debes definir este cluster en la clave <code>clusters</code> de tu configuración de Redis:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token single-quoted-string string">'redis'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>

    <span class="token single-quoted-string string">'client'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'predis'</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'clusters'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'default'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'host'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_HOST'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'localhost'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PASSWORD'</span><span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token single-quoted-string string">'port'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PORT'</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token single-quoted-string string">'database'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>Por defecto, los clusters realizarán la división del lado del cliente en sus nodos, permitiéndote agrupar nodos y crear una gran cantidad de RAM disponible. Sin embargo, ten en cuenta que la división del lado del cliente no gestiona el failover; por lo tanto, es principalmente adecuado para datos en caché que estén disponibles desde otro almacenamiento de datos primario. Su deseas utilizar el agrupamiento nativo de Redis, debes especificarlo en la clave <code>options</code> de tu configuración de Redis:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token single-quoted-string string">'redis'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>

    <span class="token single-quoted-string string">'client'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'predis'</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'options'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'cluster'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'redis'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'clusters'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p><a name="predis"></a></p> <h3 id="predis"><a class="header-anchor" href="#predis" aria-hidden="true">#</a> Predis</h3> <p>Además de las opciones predeterminadas de la configuración del servidor <code>host</code>, <code>port</code>, <code>database</code> y <code>password</code>, Predis admite <a href="https://github.com/nrk/predis/wiki/Connection-Parameters" target="_blank" rel="noopener noreferrer">parámetros de conexión<OutboundLink></OutboundLink></a> adicionales que pueden ser definidos para cada uno de tus servidores de Redis. Para utilizar estas opciones de configuración adicionales, agrégalos a la configuración del servidor de Redis en el archivo de configuración <code>config/database.php</code>:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token single-quoted-string string">'default'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'host'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_HOST'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'localhost'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PASSWORD'</span><span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'port'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PORT'</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'database'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'read_write_timeout'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">60</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p><a name="phpredis"></a></p> <h3 id="phpredis"><a class="header-anchor" href="#phpredis" aria-hidden="true">#</a> PhpRedis</h3> <p>Para utilizar la extensión PhpRedis, deberás cambiar la opción <code>client</code> de tu configuración de Redis a <code>phpredis</code>. Puedes encontrar esta opción en tu archivo de configuración <code>config/database.php</code>:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token single-quoted-string string">'redis'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>

    <span class="token single-quoted-string string">'client'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'phpredis'</span><span class="token punctuation">,</span>

    <span class="token comment">// Resto de la configuración de Redis...</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>Además de las opciones predeterminadas de configuración del servidor <code>host</code>, <code>port</code>, <code>database</code> y <code>password</code>, PhpRedis admite los siguientes parámetros de conexión adicionales: <code>persistent</code>, <code>prefix</code>, <code>read_timeout</code> y <code>timeout</code>. Puedes agregar cualquiera de estas opciones a la configuración del servidor de Redis en el archivo de configuración <code>config/database.php</code>:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token single-quoted-string string">'default'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'host'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_HOST'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'localhost'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PASSWORD'</span><span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'port'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'REDIS_PORT'</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'database'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'read_timeout'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">60</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p><a name="interacting-with-redis"></a></p> <h2 id="interactuar-con-redis"><a class="header-anchor" href="#interactuar-con-redis" aria-hidden="true">#</a> Interactuar con redis</h2> <p>Puedes interactuar con Redis llamando varios métodos en el <router-link to="/facades.html">facade</router-link> <code>Redis</code>. El facade <code>Redis</code> admite métodos dinámicos, lo que significa que puedes llamar a cualquier <a href="https://redis.io/commands" target="_blank" rel="noopener noreferrer">comando de Redis<OutboundLink></OutboundLink></a> en el facade y el comando será pasado directamente a Redis. En este ejemplo, vamos a llamar al comando <code>GET</code> de Redis llamando al método <code>get</code> en el facade <code>Redis</code>:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Redis</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Show the profile for the given user.
    *
    * @param  int  $id
    * @return Response
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">showProfile</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$user</span> <span class="token operator">=</span> Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user:profile:'</span><span class="token punctuation">.</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user.profile'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'user'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$user</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Como lo mencionamos anteriormente, puedes llamar a cualquier comando de Redis en el facade <code>Redis</code>. Laravel utiliza métodos mágicos para pasar los comandos al servidor de Redis, para que pases los argumentos que espera el comando de Redis:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code>Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Taylor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$values</span> <span class="token operator">=</span> Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">lrange</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'names'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Alternativamente, también puedes pasar comandos al servidor usando el método <code>command</code>, el cual acepta el nombre del comando como primer argumento, y un arreglo de valores como segundo argumento:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token variable">$values</span> <span class="token operator">=</span> Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'lrange'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="utilizar-multiples-conexiones-de-redis"><a class="header-anchor" href="#utilizar-multiples-conexiones-de-redis" aria-hidden="true">#</a> Utilizar múltiples conexiones de Redis</h4> <p>Puedes obtener una instancia de Redis llamando al método <code>Redis::connection</code>:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token variable">$redis</span> <span class="token operator">=</span> Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">connection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Esto te dará una instancia del servidor de Redis predeterminado. También puedes pasar la conexión o nombre del cluster al método <code>connection</code> para obtener un servidor o cluster en específico según lo definido en tu configuración de Redis:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token variable">$redis</span> <span class="token operator">=</span> Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">connection</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'my-connection'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="pipelining-commands"></a></p> <h3 id="canalizar-comandos"><a class="header-anchor" href="#canalizar-comandos" aria-hidden="true">#</a> Canalizar comandos</h3> <p>La canalización debe ser utilizada cuando envíes muchos comandos al servidor en una sola operación. El método <code>pipeline</code> acepta un argumento: un <code>Closure</code> que reciba una instancia de Redis. Puedes emitir todos tus comandos a esta instancia de Redis y después éstos serán ejecutados dentro de una sola operación:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code>Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$pipe</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$pipe</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;key:<span class="token interpolation"><span class="token variable">$i</span></span>&quot;</span><span class="token punctuation">,</span> <span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="pubsub"></a></p> <h2 id="pub-sub"><a class="header-anchor" href="#pub-sub" aria-hidden="true">#</a> Pub / Sub</h2> <p>Laravel proporciona una interfaz conveniente para los comandos <code>publish</code> y <code>subscribe</code> de Redis. Estos comandos de Redis te permiten escuchar mensajes en un &quot;canal&quot; dado. Puedes publicar mensajes en el canal desde otra aplicación, o incluso utilizando otro lenguaje de programación, lo que permite una comunicación sencilla entre aplicaciones y procesos.</p> <p>Primero, configuremos un listener para el canal usando el método <code>subscribe</code>. Vamos a colocar una llamada a este método en un <router-link to="/artisan.html">comando de Artisan</router-link> ya que llamar al método <code>subscribe</code> comienza un proceso de larga ejecución:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Console<span class="token punctuation">\</span>Commands</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Console<span class="token punctuation">\</span>Command</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Redis</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">RedisSubscribe</span> <span class="token keyword">extends</span> <span class="token class-name">Command</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * The name and signature of the console command.
    *
    * @var string
    */</span>
    <span class="token keyword">protected</span> <span class="token variable">$signature</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'redis:subscribe'</span><span class="token punctuation">;</span>

    <span class="token comment">/**
    * The console command description.
    *
    * @var string
    */</span>
    <span class="token keyword">protected</span> <span class="token variable">$description</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'Subscribe to a Redis channel'</span><span class="token punctuation">;</span>

    <span class="token comment">/**
    * Execute the console command.
    *
    * @return mixed
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'test-channel'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token variable">$message</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Ahora podemos publicar mensajes en el canal usando el método <code>publish</code>:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code>Route<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'publish'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Route logic...</span>

    Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'test-channel'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="suscripciones-de-comodines"><a class="header-anchor" href="#suscripciones-de-comodines" aria-hidden="true">#</a> Suscripciones de comodines</h4> <p>Usando el método <code>psubscribe</code>, puedes suscribirte a un canal comodín, el cual puede ser útil para capturar todos los mensajes en todos los canales. El nombre del canal <code>$channel</code> será pasado como segundo argumento al callback <code>Closure</code> proporcionado:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code>Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">psubscribe</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$message</span><span class="token punctuation">,</span> <span class="token variable">$channel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$message</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Redis<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">psubscribe</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'users.*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$message</span><span class="token punctuation">,</span> <span class="token variable">$channel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$message</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/seeding.html" class="prev">
          /seeding.html
        </a></span> <span class="next"><a href="/eloquent.html">
          /eloquent.html
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2b9ea969.js" defer></script><script src="/assets/js/2.8f57d70e.js" defer></script><script src="/assets/js/67.2883abee.js" defer></script>
  </body>
</html>
