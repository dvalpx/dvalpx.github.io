<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Documentación de Laravel</title>
    <meta name="description" content="Documentación de Laravel en Español">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Catamaran:300,700|Miriam+Libre">
  <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.1d810b70.css" as="style"><link rel="preload" href="/assets/js/app.e59a6a89.js" as="script"><link rel="preload" href="/assets/js/2.8f57d70e.js" as="script"><link rel="preload" href="/assets/js/20.98f3d85d.js" as="script"><link rel="prefetch" href="/assets/js/10.7938642f.js"><link rel="prefetch" href="/assets/js/11.b585b15b.js"><link rel="prefetch" href="/assets/js/12.f18cbc71.js"><link rel="prefetch" href="/assets/js/13.4e004220.js"><link rel="prefetch" href="/assets/js/14.716cc2f2.js"><link rel="prefetch" href="/assets/js/15.101f24d3.js"><link rel="prefetch" href="/assets/js/16.7d729c7d.js"><link rel="prefetch" href="/assets/js/17.697ee95d.js"><link rel="prefetch" href="/assets/js/18.b4b1f7a2.js"><link rel="prefetch" href="/assets/js/19.fd9838bd.js"><link rel="prefetch" href="/assets/js/21.6c9b5ce0.js"><link rel="prefetch" href="/assets/js/22.53339c00.js"><link rel="prefetch" href="/assets/js/23.ab49af56.js"><link rel="prefetch" href="/assets/js/24.93c8a909.js"><link rel="prefetch" href="/assets/js/25.117b3835.js"><link rel="prefetch" href="/assets/js/26.0d053246.js"><link rel="prefetch" href="/assets/js/27.5144960a.js"><link rel="prefetch" href="/assets/js/28.d8cd7c15.js"><link rel="prefetch" href="/assets/js/29.3c433a6b.js"><link rel="prefetch" href="/assets/js/3.37d22ff0.js"><link rel="prefetch" href="/assets/js/30.51df909b.js"><link rel="prefetch" href="/assets/js/31.edd36b1d.js"><link rel="prefetch" href="/assets/js/32.723aca49.js"><link rel="prefetch" href="/assets/js/33.baa640d1.js"><link rel="prefetch" href="/assets/js/34.df138466.js"><link rel="prefetch" href="/assets/js/35.5cbb65af.js"><link rel="prefetch" href="/assets/js/36.2e171db2.js"><link rel="prefetch" href="/assets/js/37.bec18e54.js"><link rel="prefetch" href="/assets/js/38.a7a776ca.js"><link rel="prefetch" href="/assets/js/39.ca7ad47c.js"><link rel="prefetch" href="/assets/js/4.95b68b43.js"><link rel="prefetch" href="/assets/js/40.b367ccd0.js"><link rel="prefetch" href="/assets/js/41.4ac23302.js"><link rel="prefetch" href="/assets/js/42.5ad9fa0f.js"><link rel="prefetch" href="/assets/js/43.b047d897.js"><link rel="prefetch" href="/assets/js/44.5768076f.js"><link rel="prefetch" href="/assets/js/45.d2626b04.js"><link rel="prefetch" href="/assets/js/46.25160090.js"><link rel="prefetch" href="/assets/js/47.db1a199f.js"><link rel="prefetch" href="/assets/js/48.64f86db5.js"><link rel="prefetch" href="/assets/js/49.869a49e7.js"><link rel="prefetch" href="/assets/js/5.f56202c2.js"><link rel="prefetch" href="/assets/js/50.d754ac07.js"><link rel="prefetch" href="/assets/js/51.1744e625.js"><link rel="prefetch" href="/assets/js/52.ce6bc429.js"><link rel="prefetch" href="/assets/js/53.82e0e463.js"><link rel="prefetch" href="/assets/js/54.81aa9908.js"><link rel="prefetch" href="/assets/js/55.70090109.js"><link rel="prefetch" href="/assets/js/56.13f2a282.js"><link rel="prefetch" href="/assets/js/57.af8c7f72.js"><link rel="prefetch" href="/assets/js/58.bcd70e05.js"><link rel="prefetch" href="/assets/js/59.bad03316.js"><link rel="prefetch" href="/assets/js/6.7ed940c0.js"><link rel="prefetch" href="/assets/js/60.68d4633b.js"><link rel="prefetch" href="/assets/js/61.21853300.js"><link rel="prefetch" href="/assets/js/62.09561e46.js"><link rel="prefetch" href="/assets/js/63.a797a0a8.js"><link rel="prefetch" href="/assets/js/64.aa808f04.js"><link rel="prefetch" href="/assets/js/65.ce7faef8.js"><link rel="prefetch" href="/assets/js/66.ebce9f07.js"><link rel="prefetch" href="/assets/js/67.24486d46.js"><link rel="prefetch" href="/assets/js/68.4c38da77.js"><link rel="prefetch" href="/assets/js/69.836842cc.js"><link rel="prefetch" href="/assets/js/7.56fcaf4f.js"><link rel="prefetch" href="/assets/js/70.0026298e.js"><link rel="prefetch" href="/assets/js/71.e740d466.js"><link rel="prefetch" href="/assets/js/72.1e9a3a86.js"><link rel="prefetch" href="/assets/js/73.2ec6c1d1.js"><link rel="prefetch" href="/assets/js/74.55f8f158.js"><link rel="prefetch" href="/assets/js/75.f3e00652.js"><link rel="prefetch" href="/assets/js/76.558e9237.js"><link rel="prefetch" href="/assets/js/77.29a257f7.js"><link rel="prefetch" href="/assets/js/78.5550f6ff.js"><link rel="prefetch" href="/assets/js/79.013c906a.js"><link rel="prefetch" href="/assets/js/8.c7de5777.js"><link rel="prefetch" href="/assets/js/80.0571f734.js"><link rel="prefetch" href="/assets/js/81.259c528c.js"><link rel="prefetch" href="/assets/js/82.87cc02ef.js"><link rel="prefetch" href="/assets/js/83.dc95e076.js"><link rel="prefetch" href="/assets/js/84.9ebc9d5d.js"><link rel="prefetch" href="/assets/js/85.dca0f9e9.js"><link rel="prefetch" href="/assets/js/9.52de0ad8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1d810b70.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Documentación de Laravel</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Inicio</a></div><div class="nav-item"><a href="/glossary.html" class="nav-link">Glosario</a></div><div class="nav-item"><a href="/credits.html" class="nav-link">Créditos</a></div><div class="nav-item"><a href="https://styde.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Styde
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Inicio</a></div><div class="nav-item"><a href="/glossary.html" class="nav-link">Glosario</a></div><div class="nav-item"><a href="/credits.html" class="nav-link">Créditos</a></div><div class="nav-item"><a href="https://styde.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Styde
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Primeros pasos</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Conceptos de arquitectura</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/lifecycle.html" class="sidebar-link">/lifecycle.html</a></li><li><a href="/container.html" class="active sidebar-link">/container.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/container.html#introduccion" class="sidebar-link">Introducción</a></li><li class="sidebar-sub-header"><a href="/container.html#enlaces" class="sidebar-link">Enlaces</a></li><li class="sidebar-sub-header"><a href="/container.html#resolviendo" class="sidebar-link">Resolviendo</a></li><li class="sidebar-sub-header"><a href="/container.html#eventos-del-contenedor" class="sidebar-link">Eventos del contenedor</a></li><li class="sidebar-sub-header"><a href="/container.html#psr-11" class="sidebar-link">PSR-11</a></li></ul></li><li><a href="/providers.html" class="sidebar-link">/providers.html</a></li><li><a href="/facades.html" class="sidebar-link">/facades.html</a></li><li><a href="/contracts.html" class="sidebar-link">/contracts.html</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Fundamentos</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Frontend</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Seguridad</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Profundizando</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Bases de datos</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ORM Eloquent</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Pruebas</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Paquetes oficiales</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div><h1 id="contenedor-de-servicios"><a class="header-anchor" href="#contenedor-de-servicios" aria-hidden="true">#</a> Contenedor de servicios</h1> <ul><li><a href="#introduction">Introducción</a></li> <li><a href="#binding">Enlaces</a> <ul><li><a href="#binding-basics">Fundamentos de los enlaces</a></li> <li><a href="#binding-interfaces-to-implementations">Enlazando interfaces a implementaciones</a></li> <li><a href="#contextual-binding">Enlaces contextuales</a></li> <li><a href="#tagging">Etiquetado</a></li> <li><a href="#extending-bindings">Extendiendo enlaces</a></li></ul></li> <li><a href="#resolving">Resolviendo</a> <ul><li><a href="#the-make-method">Método make</a></li> <li><a href="#automatic-injection">Inyección automática</a></li></ul></li> <li><a href="#container-events">Eventos del contenedor</a></li> <li><a href="#psr-11">PSR-11</a></li></ul> <p><a name="introduction"></a></p> <h2 id="introduccion"><a class="header-anchor" href="#introduccion" aria-hidden="true">#</a> Introducción</h2> <p>El contenedor de servicios de Laravel es una herramienta poderosa para administrar dependencias de clases y realizar inyección de dependencias. La inyección de dependencias es una frase bonita para básicamente decir: las dependencias de clases son &quot;inyectadas&quot; en la clase mediante el constructor o, en algunos casos, métodos &quot;setter&quot;.</p> <p>Echemos un vistazo a un ejemplo sencillo:</p> <div class="language-php extra-class"><pre v-pre="" class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Repositories<span class="token punctuation">\</span>UserRepository</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * The user repository implementation.
    *
    * @var UserRepository
    */</span>
    <span class="token keyword">protected</span> <span class="token variable">$users</span><span class="token punctuation">;</span>

    <span class="token comment">/**
    * Create a new controller instance.
    *
    * @param  UserRepository  $users
    * @return void
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>UserRepository <span class="token variable">$users</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">users</span> <span class="token operator">=</span> <span class="token variable">$users</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * Show the profile for the given user.
    *
    * @param  int  $id
    * @return Response
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">users</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user.profile'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'user'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$user</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>En este ejemplo, <code>UserController</code> necesita retornar usuarios desde una fuente de datos. Así que, <strong>inyectaremos</strong> un servicio que es capaz de retornar los usuarios. En este conexto, nuestro <code>UserRepository</code> probablemente usa <router-link to="/eloquent.html">Eloquent</router-link> para retornar la información de los usuarios desde la base de datos. Sin embargo, dado que el repositorio es inyectado, somos capaces de cambiarlo fácilmente con otra implementación. También somos capaces de &quot;simular&quot; o crear una implementación de ejemplo de <code>UserRepository</code> al probar nuestra aplicación.</p> <p>Un conocimiento profundo del contenedor de servicios de Laravel es esencial para construir aplicaciones grandes y poderosas así como también contribuir al núcleo de Laravel.</p> <p><a name="binding"></a></p> <h2 id="enlaces"><a class="header-anchor" href="#enlaces" aria-hidden="true">#</a> Enlaces</h2> <p><a name="binding-basics"></a></p> <h3 id="fundamentos-de-los-enlaces"><a class="header-anchor" href="#fundamentos-de-los-enlaces" aria-hidden="true">#</a> Fundamentos de los enlaces</h3> <p>La mayoría de los enlaces de tu contenedor de servicios serán registrados dentro de <router-link to="/providers.html">proveedores de servicios</router-link>, así que la mayoría de estos ejemplos muestra el uso del contenedor en ese contexto.</p> <div class="tip custom-block"><p>No hay necesidad de enlazar clases al contenedor si no dependen de ninguna interfaz. El contenedor no necesita ser instruido en cómo construir esos objetos, dado que puede resolver dichos objetos automáticamente usando reflejos.</p></div></div><h4 id="enlaces-sencillos"><a href="#enlaces-sencillos" aria-hidden="true" class="header-anchor">#</a> Enlaces sencillos</h4> <p>Dentro de un proveedor de servicios, siempre tienes acceso al contenedor mediante la propiedad <code>$this-&gt;app</code>. Podemos registrar un enlace usando el método <code>bind</code>, pasando el nombre de la clase o interfaz que deseamos registrar junto con una <code>Closure</code> que retorna una instancia de la clase:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HelpSpot\API'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HelpSpot<span class="token punctuation">\</span>API</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HttpClient'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Observa que recibimos el contenedor como argumento. Podemos entonces usar el contenedor para resolver sub-dependencias del objeto que estamos construyendo.</p> <h4 id="enlazando-un-singleton"><a href="#enlazando-un-singleton" aria-hidden="true" class="header-anchor">#</a> Enlazando un singleton</h4> <p>El método <code>singleton</code> enlaza una clase o interfaz al contenedor que debería ser resuelto una sola vez. Una vez que el enlace de un singleton es resuelto, la misma instancia de objeto será retornada en llamadas siguientes al contenedor:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HelpSpot\API'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HelpSpot<span class="token punctuation">\</span>API</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HttpClient'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="enlazando-instancias"><a href="#enlazando-instancias" aria-hidden="true" class="header-anchor">#</a> Enlazando instancias</h4> <p>También puedes enlazar una instancia de objeto existente al contenedor usando el método <code>instance</code>. La instancia dada siempre será retornada en llamadas siguientes al contenedor:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$api</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HelpSpot<span class="token punctuation">\</span>API</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HelpSpot\API'</span><span class="token punctuation">,</span> <span class="token variable">$api</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="enlazando-valores-primitivos"><a href="#enlazando-valores-primitivos" aria-hidden="true" class="header-anchor">#</a> Enlazando valores primitivos</h4> <p>Algunas veces tendrás una clase que recibe algunas clases inyectadas, pero que también necesita un valor primitivo inyectado, como un entero. Puedes fácilmente usar enlaces contextuales para inyectar cualquier valor que tu clase pueda necesitar:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">when</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'App\Http\Controllers\UserController'</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">needs</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'$variableName'</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">give</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="binding-interfaces-to-implementations"></a></p> <h3 id="enlazando-interfaces-a-implementaciones"><a href="#enlazando-interfaces-a-implementaciones" aria-hidden="true" class="header-anchor">#</a> Enlazando interfaces a implementaciones</h3> <p>Una característica muy poderosa del contenedor de servicios es su habilidad para enlazar una interfaz a una implementación dada. Por ejemplo, vamos a suponer que tenemos una interfaz <code>EventPusher</code> y una implementación <code>RedisEventPusher</code>. Una vez que hemos programado nuestra implementación <code>RedisEventPusher</code> de esta interfaz, podemos registrarla con el contenedor de servicios de la siguiente manera:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'App\Contracts\EventPusher'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'App\Services\RedisEventPusher'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Esta sentencia le dice al contenedor que debe inyectar <code>RedisEventPusher</code> cuando una clase necesita una implementación de <code>EventPusher</code>. Ahora podemos determinar el tipo de la interfaz <code>EventPusher</code> en un constructor o cualquier otra ubicación donde las dependencias son inyectadas por el contenedor de servicios:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>EventPusher</span><span class="token punctuation">;</span>

<span class="token comment">/**
* Create a new class instance.
*
* @param  EventPusher  $pusher
* @return void
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>EventPusher <span class="token variable">$pusher</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">pusher</span> <span class="token operator">=</span> <span class="token variable">$pusher</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="contextual-binding"></a></p> <h3 id="enlaces-contextuales"><a href="#enlaces-contextuales" aria-hidden="true" class="header-anchor">#</a> Enlaces contextuales</h3> <p>Algunas veces tendrás dos clases que usan la misma interfaz, pero quieres inyectar diferentes implementaciones en cada clase. Por ejemplo, dos controladores pueden depender de diferentes implementaciones del <a href="/contracts.html">contrato</a> <code>Illuminate\Contracts\Filesystem\Filesystem</code>. Laravel proporciona una simple y fluida interfaz para definir este comportamiento:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Storage</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>PhotoController</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>VideoController</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Filesystem<span class="token punctuation">\</span>Filesystem</span><span class="token punctuation">;</span>

<span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">when</span><span class="token punctuation">(</span>PhotoController<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">needs</span><span class="token punctuation">(</span>Filesystem<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">give</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> Storage<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">disk</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'local'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">when</span><span class="token punctuation">(</span><span class="token punctuation">[</span>VideoController<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> UploadController<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">needs</span><span class="token punctuation">(</span>Filesystem<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">give</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> Storage<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">disk</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'s3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="tagging"></a></p> <h3 id="etiquetado"><a href="#etiquetado" aria-hidden="true" class="header-anchor">#</a> Etiquetado</h3> <p>Ocasionalmente, puedes necesitar resolver todo de una determinada &quot;categoría&quot; de enlaces. Por ejemplo, puede que estés construyendo un agregador de reportes que recibe un arreglo de diferentes implementaciones de la interfaz <code>Report</code>. Luego de registrar las implementaciones de <code>Report</code>, puedes asignarles una etiqueta usando el método <code>tag</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'SpeedReport'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'MemoryReport'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">tag</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'SpeedReport'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'MemoryReport'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'reports'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Una vez que los servicios han sido etiquetados, puedes resolverlos fácilmente mediante el método <code>tagged</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'ReportAggregator'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ReportAggregator</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">tagged</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'reports'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="extending-bindings"></a></p> <h3 id="extendiendo-enlaces"><a href="#extendiendo-enlaces" aria-hidden="true" class="header-anchor">#</a> Extendiendo enlaces</h3> <p>El método <code>extend</code> te permite modificar servicios resueltos. Por ejemplo, cuando un servicio es resuelto, puedes ejecutar código adicional para decorar o configurar el servicio. El método <code>extend</code> acepta un Closure, que debe retornar el servicio modificado, como único argumento:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">extend</span><span class="token punctuation">(</span>Service<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$service</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DecoratedService</span><span class="token punctuation">(</span><span class="token variable">$service</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="resolving"></a></p> <h2 id="resolviendo"><a href="#resolviendo" aria-hidden="true" class="header-anchor">#</a> Resolviendo</h2> <p><a name="the-make-method"></a></p> <h4 id="metodo-make"><a href="#metodo-make" aria-hidden="true" class="header-anchor">#</a> Método <code>make</code></h4> <p>Puedes usar el método <code>make</code> para resolver una instancia de clase fuera del contenedor. El método <code>make</code> acepta el nombre de la clase o interfaz que deseas resolver:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$api</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HelpSpot\API'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si estás en una ubicación de tu código que no tiene acceso a la variable <code>$app</code>, puedes usar el helper global <code>resolve</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$api</span> <span class="token operator">=</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HelpSpot\API'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si algunas de las dependencias de tu clase no son resueltas mediante el contenedor, puedes inyectarlas pasándolas como un arreglo asociativo al método <code>makeWith</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$api</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">makeWith</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'HelpSpot\API'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="automatic-injection"></a></p> <h4 id="inyeccion-automatica"><a href="#inyeccion-automatica" aria-hidden="true" class="header-anchor">#</a> Inyección automática</h4> <p>Alternativamente, y de forma importante, puedes &quot;determinar el tipo&quot; de la dependencia en el constructor de una clase que es resuelta por el contenedor, incluyendo <a href="/controllers.html">controladores</a>, <a href="/events.html">listeners de eventos</a>, <a href="/queues.html">colas</a>, <a href="/middleware.html">middleware</a> y más. En la práctica, así es como la mayoría de tus objetos deben ser resueltos por el contenedor.</p> <p>Por ejemplo, puedes determinar el tipo de un repositorio definido por tu aplicación en el constructor de un controlador. El repositorio será automáticamente resuelto e inyectado en la clase:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>Repository</span> <span class="token keyword">as</span> UserRepository<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * The user repository instance.
    */</span>
    <span class="token keyword">protected</span> <span class="token variable">$users</span><span class="token punctuation">;</span>

    <span class="token comment">/**
    * Create a new controller instance.
    *
    * @param  UserRepository  $users
    * @return void
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>UserRepository <span class="token variable">$users</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">users</span> <span class="token operator">=</span> <span class="token variable">$users</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * Show the user with the given ID.
    *
    * @param  int  $id
    * @return Response
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p><a name="container-events"></a></p> <h2 id="eventos-del-contenedor"><a href="#eventos-del-contenedor" aria-hidden="true" class="header-anchor">#</a> Eventos del contenedor</h2> <p>El contenedor de servicios ejecuta un evento cada vez que resuelve un objeto. Puedes escuchar a este evento usando el método <code>resolving</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">resolving</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">,</span> <span class="token variable">$app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Called when container resolves object of any type...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">resolving</span><span class="token punctuation">(</span>HelpSpot\<span class="token package">API</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$api</span><span class="token punctuation">,</span> <span class="token variable">$app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Called when container resolves objects of type &quot;HelpSpot\API&quot;...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Como puedes ver, el objeto siendo resuelto será pasado a la función de retorno, permitiéndote establecer cualquier propiedad adicional en el objeto antes de que sea entregado a su consumidor.</p> <p><a name="psr-11"></a></p> <h2 id="psr-11"><a href="#psr-11" aria-hidden="true" class="header-anchor">#</a> PSR-11</h2> <p>El contenedor de servicios de Laravel implementa la interfaz <a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-11-container.md" target="_blank" rel="noopener noreferrer">PSR-11<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Por lo tanto, puedes determinar el tipo de la interfaz de contenedor PSR-11 para obtener una instancia del contenedor de Laravel:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Psr<span class="token punctuation">\</span>Container<span class="token punctuation">\</span>ContainerInterface</span><span class="token punctuation">;</span>

Route<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>ContainerInterface <span class="token variable">$container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$service</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Service'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Una excepción es mostrada si el identificador dado no puede ser resuelto. La excepción será una instancia de <code>Psr\Container\NotFoundExceptionInterface</code> si el identificador nunca fue enlazado. Si el identificador fue enlazado pero ha sido incapaz de resolver, una instancia de <code>Psr\Container\ContainerExceptionInterface</code> será mostrada.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/lifecycle.html" class="prev">
          /lifecycle.html
        </a></span> <span class="next"><a href="/providers.html">
          /providers.html
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e59a6a89.js" defer></script><script src="/assets/js/2.8f57d70e.js" defer></script><script src="/assets/js/20.98f3d85d.js" defer></script>
  </body>
</html>
