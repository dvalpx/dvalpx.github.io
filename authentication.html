<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VuePress</title>
    <meta name="generator" content="VuePress 1.8.1">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.f7a12d87.css" as="style"><link rel="preload" href="/assets/js/app.e3311cd2.js" as="script"><link rel="preload" href="/assets/js/2.648c6578.js" as="script"><link rel="preload" href="/assets/js/9.d31992a0.js" as="script"><link rel="prefetch" href="/assets/js/10.f234decd.js"><link rel="prefetch" href="/assets/js/11.f0ca56a6.js"><link rel="prefetch" href="/assets/js/12.5865c9a5.js"><link rel="prefetch" href="/assets/js/13.8e509b37.js"><link rel="prefetch" href="/assets/js/14.2d9f5c97.js"><link rel="prefetch" href="/assets/js/15.b917edb6.js"><link rel="prefetch" href="/assets/js/16.a13d2a39.js"><link rel="prefetch" href="/assets/js/17.d6b71ec0.js"><link rel="prefetch" href="/assets/js/18.adbe50b4.js"><link rel="prefetch" href="/assets/js/19.a1638529.js"><link rel="prefetch" href="/assets/js/20.393f35ab.js"><link rel="prefetch" href="/assets/js/21.a9dd9148.js"><link rel="prefetch" href="/assets/js/22.087385e4.js"><link rel="prefetch" href="/assets/js/23.b6ce1d9c.js"><link rel="prefetch" href="/assets/js/24.a74b28c6.js"><link rel="prefetch" href="/assets/js/25.7a984c35.js"><link rel="prefetch" href="/assets/js/26.cf45c453.js"><link rel="prefetch" href="/assets/js/27.e36a56dc.js"><link rel="prefetch" href="/assets/js/28.358fc226.js"><link rel="prefetch" href="/assets/js/29.f4fd2139.js"><link rel="prefetch" href="/assets/js/3.40d230a8.js"><link rel="prefetch" href="/assets/js/30.564d0795.js"><link rel="prefetch" href="/assets/js/31.0691b4c8.js"><link rel="prefetch" href="/assets/js/32.088de00e.js"><link rel="prefetch" href="/assets/js/33.4d884bb7.js"><link rel="prefetch" href="/assets/js/34.c4be32cd.js"><link rel="prefetch" href="/assets/js/35.b78c77b2.js"><link rel="prefetch" href="/assets/js/36.ceed3144.js"><link rel="prefetch" href="/assets/js/37.f9d6aca2.js"><link rel="prefetch" href="/assets/js/38.67ad3e03.js"><link rel="prefetch" href="/assets/js/39.5e3e70a7.js"><link rel="prefetch" href="/assets/js/4.e81ef12f.js"><link rel="prefetch" href="/assets/js/40.0510efa5.js"><link rel="prefetch" href="/assets/js/41.4e2bcf98.js"><link rel="prefetch" href="/assets/js/42.ebc7d9c8.js"><link rel="prefetch" href="/assets/js/43.e5970289.js"><link rel="prefetch" href="/assets/js/44.f91a9970.js"><link rel="prefetch" href="/assets/js/45.603b4584.js"><link rel="prefetch" href="/assets/js/46.037dce36.js"><link rel="prefetch" href="/assets/js/47.fadd0db4.js"><link rel="prefetch" href="/assets/js/48.457d9287.js"><link rel="prefetch" href="/assets/js/49.da492613.js"><link rel="prefetch" href="/assets/js/5.dc790133.js"><link rel="prefetch" href="/assets/js/50.cab6e13d.js"><link rel="prefetch" href="/assets/js/51.0765def4.js"><link rel="prefetch" href="/assets/js/52.518165a7.js"><link rel="prefetch" href="/assets/js/53.1e887b4a.js"><link rel="prefetch" href="/assets/js/54.bc10b491.js"><link rel="prefetch" href="/assets/js/55.2e54a7e8.js"><link rel="prefetch" href="/assets/js/56.169c81e5.js"><link rel="prefetch" href="/assets/js/57.a4ef4ed1.js"><link rel="prefetch" href="/assets/js/58.78dc0897.js"><link rel="prefetch" href="/assets/js/59.f13515c7.js"><link rel="prefetch" href="/assets/js/6.de2c94ff.js"><link rel="prefetch" href="/assets/js/60.ebfdeb63.js"><link rel="prefetch" href="/assets/js/61.6523e015.js"><link rel="prefetch" href="/assets/js/62.cb19c9bd.js"><link rel="prefetch" href="/assets/js/63.6ae10337.js"><link rel="prefetch" href="/assets/js/64.50298a81.js"><link rel="prefetch" href="/assets/js/65.d1849c5b.js"><link rel="prefetch" href="/assets/js/66.caef6860.js"><link rel="prefetch" href="/assets/js/67.a2788988.js"><link rel="prefetch" href="/assets/js/68.1c43eae0.js"><link rel="prefetch" href="/assets/js/69.e16965c5.js"><link rel="prefetch" href="/assets/js/7.0466c7e3.js"><link rel="prefetch" href="/assets/js/70.e66fe735.js"><link rel="prefetch" href="/assets/js/71.6d49148f.js"><link rel="prefetch" href="/assets/js/72.c3d54f60.js"><link rel="prefetch" href="/assets/js/73.125d4466.js"><link rel="prefetch" href="/assets/js/74.f1ed7f47.js"><link rel="prefetch" href="/assets/js/75.2f92d842.js"><link rel="prefetch" href="/assets/js/76.634dc6b8.js"><link rel="prefetch" href="/assets/js/77.db030077.js"><link rel="prefetch" href="/assets/js/78.ef9b3a22.js"><link rel="prefetch" href="/assets/js/79.a9b05b84.js"><link rel="prefetch" href="/assets/js/8.0435cf5c.js"><link rel="prefetch" href="/assets/js/80.88069fe6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f7a12d87.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><div><h1 id="autenticacion"><a class="header-anchor" href="#autenticacion">#</a> Autenticación</h1> <ul><li><a href="#introduction">Introducción</a> <ul><li><a href="#introduction-database-considerations">Consideraciones de la base de datos</a></li></ul></li> <li><a href="#authentication-quickstart">Inicio rápido de autenticación</a> <ul><li><a href="#included-routing">Enrutamiento</a></li> <li><a href="#included-views">Vistas</a></li> <li><a href="#included-authenticating">Autenticando</a></li> <li><a href="#retrieving-the-authenticated-user">Retornando el usuario autenticado</a></li> <li><a href="#protecting-routes">Proteger Rutas</a></li> <li><a href="#password-confirmation">Confirmación de contraseña</a></li> <li><a href="#login-throttling">Regulación de Inicio de Sesión</a></li></ul></li> <li><a href="#authenticating-users">Autenticar usuarios manualmente</a> <ul><li><a href="#remembering-users">Recordar usuarios</a></li> <li><a href="#other-authentication-methods">Otros métodos de autenticación</a></li></ul></li> <li><a href="#http-basic-authentication">Autenticación HTTP básica</a> <ul><li><a href="#stateless-http-basic-authentication">Autenticación HTTP básica sin estado</a></li></ul></li> <li><a href="#logging-out">Cerrar sesión</a> <ul><li><a href="#invalidating-sessions-on-other-devices">Invalidar sesiones en otros dispositivos</a></li></ul></li> <li><a href="https://github.com/laravel/socialite" target="_blank" rel="noopener noreferrer">Autenticar con redes sociales<OutboundLink></OutboundLink></a></li> <li><a href="#adding-custom-guards">Agregar guards personalizados</a> <ul><li><a href="#closure-request-guards">Guards de closures de peticiones</a></li></ul></li> <li><a href="#adding-custom-user-providers">Agregar proveedores de usuarios personalizados</a> <ul><li><a href="#the-user-provider-contract">La interfaz UserProvider</a></li> <li><a href="#the-authenticatable-contract">La interfaz Authenticatable</a></li></ul></li> <li><a href="#events">Eventos</a></li></ul> <p><a name="introduction"></a></p> <h2 id="introduccion"><a class="header-anchor" href="#introduccion">#</a> Introducción</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><strong>¿Quieres comenzar rápido?</strong> Instala el paquete de Composer <code>laravel/ui</code> (1.0) y ejecuta <code>php artisan ui vue --auth</code> en una nueva aplicación de Laravel. Luego de migrar tu base de datos, dirígete en tu navegador a <code>http://tu-app.test/register</code> o cualquier otra URL asignada a tu aplicación. ¡Estos dos comandos se encargarán de generar todo el sistema de autenticación!</p></div></div><p>Laravel hace la implementación de la autenticación algo muy sencillo. De hecho, casi todo se configura para ti por defecto. El archivo de configuración de la autenticación está localizado en <code>config/auth.php</code>, el cual contiene varias opciones bien documentadas para ajustar el comportamiento de los servicios de autenticación.</p> <p>En esencia, las características de la autenticación de Laravel están compuestas de &quot;guards&quot; (guardias) y &quot;providers&quot; (proveedores). Los Guards definen cómo los usuarios son autenticados para cada petición. Por ejemplo, Laravel contiene un guard <code>session</code> el cual mantiene el estado utilizando el almacenamiento de sesión y las cookies.</p> <p>Los proveedores definen cómo se retornan los usuarios de tu almacenamiento persistente. Laravel cuenta con soporte para recuperar los usuarios utilizando Eloquent y el constructor de consultas de la base de datos. Sin embargo, eres libre de definir los proveedores adicionales que requiera tu aplicación.</p> <p>¡No te preocupes si esto suena confuso por el momento! Muchas aplicaciones nunca necesitarán modificar la configuración predeterminada de la autenticación.</p> <p><a name="introduction-database-considerations"></a></p> <h3 id="consideraciones-de-la-base-de-datos"><a href="#consideraciones-de-la-base-de-datos" class="header-anchor">#</a> Consideraciones de la base de datos</h3> <p>De manera predeterminada, Laravel incluye un <a href="/eloquent.html">Modelo de Eloquent</a> <code>App\User</code> en tu directorio <code>app</code>. Este modelo puede ser utilizado por el controlador de autenticación predeterminado de Eloquent. Si tu aplicación no utiliza Eloquent, deberás utilizar el controlador de autenticación <code>database</code> el cual utiliza el constructor de consultas (query builder) de Laravel.</p> <p>Al crear el esquema de la base de datos para el modelo <code>App\User</code>, asegúrate de que la columna password sea de al menos 60 caracteres de longitud. Mantener una longitud de columna de cadena predeterminada a 255 caracteres sería una buena opción.</p> <p>Además, debes verificar que tu tabla <code>users</code> (o equivalente) contenga un campo nulo de tipo cadena llamado <code>remember_token</code> de 100 caracteres. Esta columna se usará para almacenar un token para los usuarios que seleccionen la opción &quot;remember me&quot; (recuérdame) cuando inicien sesión en tu aplicación.</p> <p><a name="authentication-quickstart"></a></p> <h2 id="inicio-rapido-de-autenticacion"><a href="#inicio-rapido-de-autenticacion" class="header-anchor">#</a> Inicio rápido de autenticación</h2> <p>Laravel viene con varios controladores de autenticación preconstruidos, los cuales están localizados en el espacio de nombre <code>App\Http\Controllers\Auth</code>. <code>RegisterController</code> maneja el registro de usuarios nuevos, <code>LoginController</code> maneja la autenticación, <code>ForgotPasswordController</code> maneja el envío de correos electrónicos para restablecer la contraseña y <code>ResetPasswordController</code> contiene la lógica para reiniciar contraseñas. Cada uno de estos controladores utiliza un trait para incluir los métodos necesarios. Para muchas aplicaciones, no necesitarás modificar estos controladores en lo absoluto.</p> <p><a name="included-routing"></a></p> <h3 id="enrutamiento"><a href="#enrutamiento" class="header-anchor">#</a> Enrutamiento</h3> <p>El paquete de Laravel <code>laravel/ui</code> proporciona una manera rápida de generar todas las rutas y vistas que necesitas para la autenticación con unos simples comandos:</p> <div class="language-php extra-class"><pre class="language-php"><code>composer <span class="token keyword">require</span> laravel<span class="token operator">/</span>ui <span class="token string double-quoted-string">&quot;^1.0&quot;</span> <span class="token operator">--</span>dev

php artisan ui vue <span class="token operator">--</span>auth
</code></pre></div><p>Este comando debe ser utilizado en aplicaciones nuevas e instalará vistas de diseño, registro e inicio de sesión, así como todas las rutas necesarias para la autenticación. También será generado un <code>HomeController</code> que se encargará de manejar las peticiones posteriores al login, como mostrar el dashboard de tu aplicación.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Si tu aplicación no necesita registro, puedes desactivarlo eliminando el <code>RegisterController</code> recién creado y modificando tu declaración de ruta: <code>Auth::routes(['register' =&gt; false]);</code>.</p></div> <h4 id="crear-aplicaciones-incluyendo-autenticacion"><a href="#crear-aplicaciones-incluyendo-autenticacion" class="header-anchor">#</a> Crear aplicaciones incluyendo autenticación</h4> <p>Si estás creando una nueva aplicación y te gustaría incluir autenticación, puedes usar la directiva <code>--auth</code> al crear tu aplicación. Este comando creará una nueva aplicación con toda la estructura de autenticación compilada e instalada:</p> <div class="language-php extra-class"><pre class="language-php"><code>laravel <span class="token keyword">new</span> <span class="token class-name">blog</span> <span class="token operator">--</span>auth
</code></pre></div><p><a name="included-views"></a></p> <h3 id="vistas"><a href="#vistas" class="header-anchor">#</a> Vistas</h3> <p>Como se mencionó en la sección anterior, el comando <code>php artisan ui vue --auth</code> del paquete <code>laravel/ui</code> creará todas las vistas que se necesiten para la autenticación y las colocará en el directorio <code>resources/views/auth</code>.</p> <p>El comando <code>ui</code> también creará el directorio <code>resources/views/layouts</code>, el cual contendrá la plantilla base para tu aplicación. Todas estas vistas usan el framework de CSS Bootstrap, pero eres libre de modificarlo en base a tus preferencias.</p> <p><a name="included-authenticating"></a></p> <h3 id="autenticacion-2"><a href="#autenticacion-2" class="header-anchor">#</a> Autenticación</h3> <p>Ahora que ya tienes tus rutas y vistas configuradas para los controladores de autenticación incluidos con el framework, ¡estás listo para registrar y autenticar usuarios nuevos para tu aplicación! Puedes acceder a tu aplicación en el navegador ya que los controladores de autenticación contienen la lógica (a través de traits) para autenticar usuarios existentes y almacenar usuarios nuevos en la base de datos.</p> <h4 id="personalizar-rutas"><a href="#personalizar-rutas" class="header-anchor">#</a> Personalizar rutas</h4> <p>Cuando un usuario se ha autenticado exitosamente, será redirigido a la URI <code>/home</code>. Puedes personalizar la ruta de redirección post-autenticación usando la constante <code>HOME</code> definida en tu <code>RouteServiceProvider</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token constant">HOME</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/home'</span><span class="token punctuation">;</span>
</code></pre></div><p>Si necesitas una mayor personalización de la respuesta que se devuelve cuando el usuario es autenticado, Laravel proporciona un método <code>authenticated(Request $request, $user)</code> que puedes usar para cambiarla si lo deseas.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* The user has been authenticated.
*
* @param  \Illuminate\Http\Request  $request
* @param  mixed  $user
* @return mixed
*/</span>
<span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token comment">//</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="personalizar-usuario"><a href="#personalizar-usuario" class="header-anchor">#</a> Personalizar usuario</h4> <p>Por defecto, Laravel utiliza el campo <code>email</code> para la autenticación. Si deseas modificar esto, puedes definir un método <code>username</code> en <code>LoginController</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">username</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string single-quoted-string">'username'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="personalizar-guard"><a href="#personalizar-guard" class="header-anchor">#</a> Personalizar guard</h4> <p>También puedes personalizar el &quot;guard&quot; que es utilizado para autenticar y registrar usuarios. Para empezar, define un método <code>guard</code> en <code>LoginController</code>, <code>RegisterController</code> y <code>ResetPasswordController</code>. Este método debe devolver una instancia de guard:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function">guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">guard</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'guard-name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="validacion-personalizar-almacenamiento"><a href="#validacion-personalizar-almacenamiento" class="header-anchor">#</a> Validación / Personalizar almacenamiento</h4> <p>Para modificar los campos del formulario que son requeridos cuando se registren usuarios nuevos en tu aplicación, o para personalizar cómo los nuevos usuarios son almacenados en tu base de datos, puedes modificar la clase <code>RegisterController</code>. Esta clase es responsable de validar y crear usuarios nuevos en tu aplicación.</p> <p>El método <code>validator</code> de <code>RegisterController</code> contiene las reglas de validación para los usuarios nuevos de tu aplicación. Eres libre de modificar este método según te convenga.</p> <p>El método <code>create</code> de <code>RegisterController</code> es responsable de crear registros nuevos de <code>App\User</code> en tu base de datos usando el <a href="/eloquent.html">ORM Eloquent</a>. Eres libre de modificar este método de acuerdo a las necesidades de tu base de datos.</p> <p><a name="retrieving-the-authenticated-user"></a></p> <h3 id="retornando-el-usuario-autenticado"><a href="#retornando-el-usuario-autenticado" class="header-anchor">#</a> Retornando el usuario autenticado</h3> <p>Puedes acceder al usuario autenticado por medio del facade <code>Auth</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token comment">// Get the currently authenticated user...</span>
<span class="token variable">$user</span> <span class="token operator">=</span> <span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get the currently authenticated user's ID...</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Alternativamente, una vez que el usuario haya sido autenticado, puedes acceder al usuario autenticado mediante una instancia de <code>Illuminate\Http\Request</code>. Recuerda que las clases a las cuales se le declaren el tipo serán inyectadas automáticamente en los métodos de tu controlador:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ProfileController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
        * Update the user's profile.
        *
        * @param  Request  $request
        * @return Response
        */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// $request-&gt;user() returns an instance of the authenticated user...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h4 id="determinar-si-el-usuario-actual-esta-autenticado"><a href="#determinar-si-el-usuario-actual-esta-autenticado" class="header-anchor">#</a> Determinar si el usuario actual está autenticado</h4> <p>Para determinar si el usuario actual está logueado en tu aplicación, puedes usar el método <code>check</code> del facade <code>Auth</code>, el cual devolverá <code>true</code> si el usuario está autenticado:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The user is logged in...</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Aún cuando es posible determinar si un usuario está autenticado utilizando el método <code>check</code>, típicamente deberás usar un middleware para verificar que el usuario está autenticado antes de permitir al usuario acceder a ciertas rutas / controladores. Para aprender más acerca de esto, da un vistazo a la documentación para <a href="/authentication.html#protecting-routes">proteger rutas</a>.</p></div> <p><a name="protecting-routes"></a></p> <h3 id="proteger-rutas"><a href="#proteger-rutas" class="header-anchor">#</a> Proteger rutas</h3> <p>Puedes utilizar <a href="/middleware.html">middleware de rutas</a> para permitir acceder a ciertas rutas a los usuarios autenticados. Laravel incluye un middleware <code>auth</code>, el cual está definido en <code>Illuminate\Auth\Middleware\Authenticate</code>. Ya que este middleware está registrado en tu kernel HTTP, todo lo que necesitas hacer es adjuntar el middleware a la definición de la ruta:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'profile'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Only authenticated users may enter...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">middleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'auth'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si estás utilizando <a href="/controllers.html">controladores</a>, puedes hacer una llamada al método <code>middleware</code> desde el constructor de tu controlador en lugar de adjuntarlo a la definición de la ruta:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">middleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'auth'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="redireccionar-usuarios-no-autenticados"><a href="#redireccionar-usuarios-no-autenticados" class="header-anchor">#</a> Redireccionar usuarios no autenticados</h4> <p>Cuando el middleware <code>auth</code> detecta un usuario no autorizado, redirigirá al usuario a la <a href="/routing.html#named-routes">ruta nombrada</a> <code>login</code>. Puedes modificar este comportamiento actualizando la función <code>redirectTo</code> en tu archivo <code>app/Http/Middleware/Authenticate.php</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the path the user should be redirected to.
*
* @param  \Illuminate\Http\Request  $request
* @return string
*/</span>
<span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">route</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="especificar-un-guard"><a href="#especificar-un-guard" class="header-anchor">#</a> Especificar un guard</h4> <p>Cuando adjuntes el middleware <code>auth</code> a una ruta, también puedes especificar cuál guard deberá ser utilizado para autenticar al usuario. El guard especificado deberá corresponder a una de las llaves en el arreglo <code>guards</code> de tu archivo de configuración <code>auth.php</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">middleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'auth:api'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="password-confirmation"></a></p> <h3 id="confirmacion-de-contrasena"><a href="#confirmacion-de-contrasena" class="header-anchor">#</a> Confirmación de contraseña</h3> <p>Algunas veces, puedes querer requerir al usuario la confirmación de su contraseña antes de acceder a alguna área específica de tu aplicación. Por ejemplo, puedes requerir esto antes de que el usuario modifique cualquier configuración de facturación dentro de la aplicación.</p> <p>Para lograr esto, Laravel proporciona un middleware <code>password.confirm</code>. Adjuntar el middleware <code>password.confirm</code> a una ruta redireccionará a los usuarios a una pantalla donde necesitan confirmar su contraseña antes de continuar:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/settings/security'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Users must confirm their password before continuing...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">middleware</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'auth'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'password.confirm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Luego de que el usuario ha confirmado con éxito su contraseña, este será redirigido a la ruta a la que originalmente intentó acceder. Por defecto, luego de confirmar su contraseña, el usuario no tendrá que confirmar su contraseña de nuevo por tres horas. Eres libre de personalizar el período de tiempo antes de que el usuario deba volver a confirmar su contraseña usando la opción de configuración <code>auth.password_timeout</code>.</p> <p><a name="login-throttling"></a></p> <h3 id="regulacion-de-inicio-de-sesion"><a href="#regulacion-de-inicio-de-sesion" class="header-anchor">#</a> Regulación de Inicio de Sesión</h3> <p>Si estás utilizando la clase <code>LoginController</code> incorporada en Laravel, el trait <code>Illuminate\Foundation\Auth\ThrottlesLogins</code> se encontrará incluido en tu controlador. De manera predeterminada, el usuario no será capaz de iniciar sesión durante un minuto si falla al proveer las credenciales correctas después de varios intentos. El regulador (o throttle) es único para el nombre de usuario / dirección de correo electrónico del usuario y su dirección IP.</p> <p><a name="authenticating-users"></a></p> <h2 id="autenticar-usuarios-manualmente"><a href="#autenticar-usuarios-manualmente" class="header-anchor">#</a> Autenticar usuarios manualmente</h2> <p>Nota que no estás obligado a utilizar los controladores de autenticación incluidos en Laravel. Si deseas eliminar estos controladores, tendrás que encargarte de administrar la autenticación de usuarios utilizando las clases de autenticación de Laravel directamente. No te preocupes, ¡es algo sencillo!.</p> <p>Vamos a acceder a los servicios de autenticación de Laravel por medio del <a href="/facades.html">facade</a> <code>Auth</code>, así que hay que asegurarnos de importar el facade <code>Auth</code> al inicio de la clase. Después, veamos el método <code>attempt</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LoginController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Handle an authentication attempt.
    *
    * @param  \Illuminate\Http\Request $request
    *
    * @return Response
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$credentials</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">only</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'email'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">attempt</span><span class="token punctuation">(</span><span class="token variable">$credentials</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Authentication passed...</span>
            <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">intended</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'dashboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>El método <code>attempt</code> acepta un arreglo de pares llave / valor como primer argumento. Los valores en el arreglo serán utilizados para encontrar el usuario en la tabla de tu base de datos. Así que, en el ejemplo anterior, el usuario se obtiene por el valor de la columna <code>email</code>. Si se encuentra el usuario, la contraseña encriptada obtenida de la base de datos será comparada con el valor <code>password</code> pasado al método en el arreglo. No debes encriptar la contraseña especificada para el valor <code>password</code>, ya que el framework automáticamente va a encriptarlo antes de compararlo con la contraseña almacenada en la base de datos. Si las dos contraseñas encriptadas coinciden, se iniciará una sesión autenticada para el usuario.</p> <p>El método <code>attempt</code> va a devolver <code>true</code> si la autenticación fue exitosa. De otra forma, devolverá <code>false</code>.</p> <p>El método <code>intended</code> del redireccionador va a redirigir al usuario a la URL que intentaba acceder antes de ser interceptado por el middleware de autenticación. Una URI de fallback puede ser proporcionada al método en caso de que el destino solicitado no esté disponible.</p> <h4 id="especificar-condiciones-adicionales"><a href="#especificar-condiciones-adicionales" class="header-anchor">#</a> Especificar condiciones adicionales</h4> <p>Si lo deseas, puedes agregar condiciones extras a la consulta de autenticación además del correo electrónico del usuario y su contraseña. Por ejemplo, podemos verificar que un usuario esté marcado como &quot;active&quot;:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">attempt</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'email'</span> <span class="token operator">=&gt;</span> <span class="token variable">$email</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'password'</span> <span class="token operator">=&gt;</span> <span class="token variable">$password</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'active'</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The user is active, not suspended, and exists.</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">Nota</p> <p>En estos ejemplos, <code>email</code> no es una opción obligatoria, solamente es utilizado como ejemplo. Debes utilizar cualquier columna que corresponda a &quot;username&quot; en tu base de datos.</p></div> <h4 id="acceso-a-instancias-especificas-de-guard"><a href="#acceso-a-instancias-especificas-de-guard" class="header-anchor">#</a> Acceso a instancias específicas de guard</h4> <p>Puedes especificar qué instancia de guard deseas usar utilizando el método <code>guard</code> en el facade <code>Auth</code>. Esto te permitirá administrar la autenticación para partes separadas de tu aplicación utilizando modelos autenticables o tablas de usuarios independientes.</p> <p>El nombre del guard pasado al método <code>guard</code> deberá corresponder a uno de los guards configurados en tu archivo de configuración <code>auth.php</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">guard</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">attempt</span><span class="token punctuation">(</span><span class="token variable">$credentials</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="cerrar-sesion"><a href="#cerrar-sesion" class="header-anchor">#</a> Cerrar sesión</h4> <p>Para desconectar usuarios de tu aplicación, debes utilizar el método <code>logout</code> del facade <code>Auth</code>. Esto va a borrar la información de autenticación en la sesión del usuario:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="remembering-users"></a></p> <h3 id="recordar-usuarios"><a href="#recordar-usuarios" class="header-anchor">#</a> Recordar usuarios</h3> <p>Si desea proporcionar la funcionalidad de &quot;recordar datos&quot; en tu aplicación, puedes pasar un valor booleano como segundo argumento al método <code>attempt</code>, que mantendrá al usuario autenticado indefinidamente, o hasta que cierre su sesión manualmente. Tu tabla <code>users</code> deberá incluir una columna de tipo string llamada <code>remember_token</code>, que será utilizada para almacenar el token &quot;recordar datos&quot;.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">attempt</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'email'</span> <span class="token operator">=&gt;</span> <span class="token variable">$email</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'password'</span> <span class="token operator">=&gt;</span> <span class="token variable">$password</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$remember</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The user is being remembered...</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Si estás utilizando el <code>LoginController</code> integrado en tu instalación de Laravel, la lógica apropiada para &quot;recordar&quot; usuarios ya se encontrará implementada por los traits utilizados por el controlador.</p></div> <p>Si estás &quot;recordando&quot; usuarios, puedes utilizar el método <code>viaRemember</code> para determinar si el usuario se ha autenticado utilizando la cookie &quot;recordar datos&quot;:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">viaRemember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="other-authentication-methods"></a></p> <h3 id="otros-metodos-de-autenticacion"><a href="#otros-metodos-de-autenticacion" class="header-anchor">#</a> Otros métodos de autenticación</h3> <h4 id="autenticar-una-instancia-de-usuario"><a href="#autenticar-una-instancia-de-usuario" class="header-anchor">#</a> Autenticar una instancia de usuario</h4> <p>Si necesitas registrar una instancia de usuario existente en tu aplicación, puedes llamar al método <code>login</code> con la instancia de usuario. El objeto proporcionado deberá ser una implementación de la <a href="/contracts.html">interfaz</a> <code>Illuminate\Contracts\Auth\Authenticatable</code>. El modelo <code>App\User</code> incluido en Laravel ya implementa esta interfaz:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Login and &quot;remember&quot; the given user...</span>
<span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Puedes especificar la instancia de guard que desees utilizar:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">guard</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="autenticar-un-usuario-por-id"><a href="#autenticar-un-usuario-por-id" class="header-anchor">#</a> Autenticar un usuario por ID</h4> <p>Para autenticar un usuario en tu aplicación por su ID, debes usar el método <code>loginUsingId</code>. Este método acepta la clave primaria del usuario que deseas autenticar:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">loginUsingId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Login and &quot;remember&quot; the given user...</span>
<span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">loginUsingId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="autenticar-un-usuario-una-vez"><a href="#autenticar-un-usuario-una-vez" class="header-anchor">#</a> Autenticar un usuario una vez</h4> <p>Puedes utilizar el método <code>once</code> para autenticar un usuario en tu aplicación para una única solicitud. No se utilizarán sesiones o cookies, lo que significa que este método puede ser bastante útil al construir una API sin estado:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token variable">$credentials</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="http-basic-authentication"></a></p> <h2 id="autenticacion-http-basica"><a href="#autenticacion-http-basica" class="header-anchor">#</a> Autenticación HTTP básica</h2> <p>La <a href="https://en.wikipedia.org/wiki/Basic_access_authentication" target="_blank" rel="noopener noreferrer">autenticación HTTP básica<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> proporciona una manera rápida de autenticar usuarios en tu aplicación sin configurar una página de &quot;login&quot; dedicada. Para iniciar, adjunta el <a href="/middleware.html">middleware</a> <code>auth.basic</code> a tu ruta. El middleware <code>auth.basic</code> está incluido en el framework de Laravel, por lo que no hay necesidad de definirlo:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'profile'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Only authenticated users may enter...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">middleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'auth.basic'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Una vez que el middleware haya sido adjuntado a la ruta, se preguntará automáticamente por las credenciales al acceder a la ruta desde tu navegador. Por defecto, el middleware <code>auth.basic</code> va a usar la columna <code>email</code> en el registro del usuario como &quot;nombre de usuario&quot;.</p> <h4 id="una-nota-sobre-fastcgi"><a href="#una-nota-sobre-fastcgi" class="header-anchor">#</a> Una nota sobre FastCGI</h4> <p>Si estás usando PHP FastCGI, la Autenticación Básica HTTP podría no funcionar correctamente por defecto. Las siguientes líneas deberán ser agregadas a tu archivo <code>.htaccess</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>RewriteCond <span class="token operator">%</span><span class="token punctuation">{</span><span class="token argument-name">HTTP</span><span class="token punctuation">:</span>Authorization<span class="token punctuation">}</span> <span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">.</span><span class="token operator">+</span><span class="token punctuation">)</span>$
RewriteRule <span class="token operator">.</span><span class="token operator">*</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token constant">E</span><span class="token operator">=</span><span class="token argument-name">HTTP_AUTHORIZATION</span><span class="token punctuation">:</span><span class="token operator">%</span><span class="token punctuation">{</span><span class="token argument-name">HTTP</span><span class="token punctuation">:</span>Authorization<span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><p><a name="stateless-http-basic-authentication"></a></p> <h3 id="autenticacion-http-basica-sin-estado"><a href="#autenticacion-http-basica-sin-estado" class="header-anchor">#</a> Autenticación HTTP básica sin estado</h3> <p>También puedes utilizar la Autenticación HTTP Básica sin establecer una cookie de identificación en la sesión, esto es particularmente útil para la autenticación API. Para hacer esto <a href="/middleware.html">define un middleware</a> que llame al método <code>onceBasic</code>. Si el método <code>onceBasic</code> no devuelve ninguna respuesta, la petición puede pasarse a la aplicación:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Middleware</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AuthenticateOnceWithBasicAuth</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Handle an incoming request.
    *
    * @param  \Illuminate\Http\Request  $request
    * @param  \Closure  $next
    * @return mixed
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$next</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">onceBasic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span><span class="token punctuation">:</span> <span class="token variable">$next</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</span></code></pre></div><p>A continuación, <a href="/middleware.html#registering-middleware">registra el middleware de ruta</a> y adjúntalo a la ruta:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'api/user'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Only authenticated users may enter...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">middleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'auth.basic.once'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="logging-out"></a></p> <h2 id="cerrar-sesion-2"><a href="#cerrar-sesion-2" class="header-anchor">#</a> Cerrar sesión</h2> <p>Para cerrar manualmente la sesión de un usuario en tu aplicación, puedes usar el método <code>logout</code> en el facade <code>Auth</code>. Esto limpiará la información de autenticación en la sesión del usuario:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="invalidating-sessions-on-other-devices"></a></p> <h3 id="invalidando-sesiones-en-otros-dispositivos"><a href="#invalidando-sesiones-en-otros-dispositivos" class="header-anchor">#</a> Invalidando sesiones en otros dispositivos</h3> <p>Laravel también proporciona un mecanismo para invalidar y &quot;sacar&quot; las sesiones de un usuario que están activas en otros dispositivos sin invalidar la sesión en el dispositivo actual. Esta característica es típicamente utilizada cuando un usuario está cambiando o actualizando su contraseña y te gustaría invalidar sesiones en otros dispositivos mientras mantienes el dispositivo actual autenticado.</p> <p>Antes de comenzar, debes asegurarte de que el middleware <code>Illuminate\Session\Middleware\AuthenticateSession</code> está presente y no está comentado en tu clase <code>app/Http/Kernel.php</code> del grupo de middleware <code>web</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token string single-quoted-string">'web'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token comment">// ...</span>
    <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>Illuminate<span class="token punctuation">\</span>Session<span class="token punctuation">\</span>Middleware<span class="token punctuation">\</span>AuthenticateSession</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">]</span>
</code></pre></div><p>Luego, puedes usar el método <code>logoutOtherDevices</code> en el facade <code>Auth</code>. Este método requiere que el usuario proporcione su contraseña actual, que tu aplicación debe aceptar mediante un campo de formulario:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">logoutOtherDevices</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Cuando el método <code>logoutOtherDevices</code> es invocado, las otras sesiones del usuario serán invalidadas completamente, lo que quiere decir que serán &quot;sacadas&quot; de todos los guards en los que previamente estaban autenticadas.</p> <div class="custom-block danger"><p class="custom-block-title">Nota</p> <p>Al usar el middleware <code>AuthenticateSession</code> en combinación con un nombre de ruta personalizado para la ruta <code>login</code>, debes sobrescribir el método <code>unauthenticated</code> en el manejador de excepciones de tu aplicación para redirigir apropiadamente a los usuarios a tu página de inicio de sesión.</p></div> <p><a name="adding-custom-guards"></a></p> <h2 id="agregar-guards-personalizados"><a href="#agregar-guards-personalizados" class="header-anchor">#</a> Agregar guards personalizados</h2> <p>Puedes definir tu propio guard de autenticación utilizando el método <code>extend</code> en el facade <code>Auth</code>. Debes colocar la llamada a este método <code>extend</code> en el <a href="/providers.html">proveedor de servicios</a>. Ya que Laravel cuenta con un <code>AuthServiceProvider</code>, puedes colocar el código en ese proveedor:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Providers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Services<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>JwtGuard</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Providers<span class="token punctuation">\</span>AuthServiceProvider</span> <span class="token keyword">as</span> ServiceProvider<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AuthServiceProvider</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceProvider</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Register any application authentication / authorization services.
    *
    * @return void
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">registerPolicies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'jwt'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">,</span> <span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Return an instance of Illuminate\Contracts\Auth\Guard...</span>

            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JwtGuard</span><span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">createUserProvider</span><span class="token punctuation">(</span><span class="token variable">$config</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'provider'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Como puedes ver en el ejemplo anterior, el callback pasado al método <code>extend</code> deberá retornar una implementación de <code>Illuminate\Contracts\Auth\Guard</code>. Esta interfaz contiene algunos métodos que tendrás que implementar para definir un guard personalizado. Una vez que tu guard personalizado haya sido definido, podrás utilizar este guard en la configuración <code>guards</code> de tu archivo de configuración <code>auth.php</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token string single-quoted-string">'guards'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'api'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'driver'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'jwt'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'provider'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'users'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p><a name="closure-request-guards"></a></p> <h3 id="guards-de-closures-de-peticiones"><a href="#guards-de-closures-de-peticiones" class="header-anchor">#</a> Guards de closures de peticiones</h3> <p>La forma más sencilla de implementar un sistema de autenticación basado en peticiones HTTP es usando el método <code>Auth:viaRequest</code>. Este método te permite definir rápidamente tu proceso de autenticación usando sólo un Closure.</p> <p>Para comenzar, llama al método <code>Auth::viaRequest</code> dentro del método <code>boot</code> de tu <code>AuthServiceProvider</code>. El método <code>viaRequest</code> acepta el nombre de un driver de autenticación como su primer argumento. Este nombre puede ser cualquier cadena que describa tu guard personalizado. El segundo argumento pasado al método debe ser un Closure que reciba la petición HTTP entrante y retorne una instancia de usuario o, si la autenticación falla, <code>null</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token comment">/**
* Register any application authentication / authorization services.
*
* @return void
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">registerPolicies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">viaRequest</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'custom-token'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">,</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token property">token</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Una vez que tu driver de autenticación personalizado ha sido definido, úsalo como un driver dentro de la configuración de <code>guards</code> de tu archivo de configuración <code>auth.php</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token string single-quoted-string">'guards'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'api'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'driver'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'custom-token'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p><a name="adding-custom-user-providers"></a></p> <h2 id="agregar-proveedores-de-usuario-personalizados"><a href="#agregar-proveedores-de-usuario-personalizados" class="header-anchor">#</a> Agregar proveedores de usuario personalizados</h2> <p>Si no estás utilizando una base de datos relacional tradicional para almacenar a tus usuarios, deberás extender Laravel con tu propio proveedor de autenticación. Usaremos el método <code>provider</code> en el facade <code>Auth</code> para definir un proveedor de usuarios personalizado:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Providers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Extensions<span class="token punctuation">\</span>RiakUserProvider</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Providers<span class="token punctuation">\</span>AuthServiceProvider</span> <span class="token keyword">as</span> ServiceProvider<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AuthServiceProvider</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceProvider</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Register any application authentication / authorization services.
    *
    * @return void
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">registerPolicies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">provider</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'riak'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Return an instance of Illuminate\Contracts\Auth\UserProvider...</span>

            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RiakUserProvider</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'riak.connection'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Después de haber registrado el proveedor utilizando el método <code>provider</code>, puedes cambiar al nuevo proveedor de usuarios en tu archivo de configuración <code>auth.php</code>. Primero, define un <code>provider</code> que utilice tu nuevo controlador:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token string single-quoted-string">'providers'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'users'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'driver'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'riak'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>Finalmente, puedes utilizar este proveedor en tu configuración de <code>guards</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token string single-quoted-string">'guards'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'web'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'driver'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'session'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'provider'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'users'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p><a name="the-user-provider-contract"></a></p> <h3 id="la-interfaz-userprovider"><a href="#la-interfaz-userprovider" class="header-anchor">#</a> La interfaz UserProvider</h3> <p>Las implementaciones <code>Illuminate\Contracts\Auth\UserProvider</code> son responsables solamente de obtener una implementación de <code>Illuminate\Contracts\Auth\Authenticatable</code> desde un sistema de almacenamiento persistente, como MySQL, Riak, etc. Estas dos interfaces permiten a los mecanismos de autenticación de Laravel continuar funcionando independientemente de cómo esté almacenada la información del usuario o qué tipo de clase es utilizada para representarlo.</p> <p>Demos un vistazo a la interfaz <code>Illuminate\Contracts\Auth\UserProvider</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">UserProvider</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">retrieveById</span><span class="token punctuation">(</span><span class="token variable">$identifier</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">retrieveByToken</span><span class="token punctuation">(</span><span class="token variable">$identifier</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">updateRememberToken</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Authenticatable</span> <span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">retrieveByCredentials</span><span class="token punctuation">(</span><span class="token keyword type-hint">array</span> <span class="token variable">$credentials</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">validateCredentials</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Authenticatable</span> <span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$credentials</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>La función <code>retrieveById</code> generalmente recibe una clave que representa al usuario, como un ID auto-incrementable de una base de datos MySQL. La implementación <code>Authenticatable</code> que coincida con el ID deberá ser recuperada y retornada por el método.</p> <p>La función <code>retrieveByToken</code> recupera un usuario por su <code>$identifier</code> único y su <code>$token</code> &quot;recordar datos&quot;, almacenados en el campo <code>remember_token</code>. Como en el método anterior, la implementación <code>Authenticatable</code> deberá ser retornada.</p> <p>El método <code>updateRememberToken</code> actualiza el campo <code>$user</code> y <code>remember_token</code> con el nuevo <code>$token</code>. Un nuevo token es asignado en un inicio de sesión con &quot;recordar datos&quot; o cuando el usuario cierre su sesión.</p> <p>El método <code>retrieveByCredentials</code> recupera el arreglo de credenciales pasadas al método <code>Auth::attempt</code> cuando intenta loguearse a la aplicación. El método &quot;consulta&quot; el almacenamiento persistente en busca de las credenciales que coincidan con las del usuario. Típicamente, este método va a ejecutar una consulta con una condición &quot;where&quot; en <code>$credentials['username']</code>. El método deberá retornar una implementación de <code>Authenticatable</code>. <strong>Este método no debe intentar realizar ninguna validación o autenticación por contraseña.</strong></p> <p>El método <code>validateCredentials</code> deberá comparar el <code>$user</code> proporcionado con sus <code>$credentials</code> para autenticar el usuario. Por ejemplo, este método puede utilizar <code>Hash::check</code> para comparar el valor de <code>$user-&gt;getAuthPassword()</code> al valor de <code>$credentials['password']</code>. Este método deberá retornar <code>true</code> o <code>false</code> indicando si la contraseña es válida o no.</p> <p><a name="the-authenticatable-contract"></a></p> <h3 id="la-interfaz-authenticatable"><a href="#la-interfaz-authenticatable" class="header-anchor">#</a> La interfaz Authenticatable</h3> <p>Ahora que hemos explorado cada uno de los métodos en <code>UserProvider</code>, vamos a dar un vistazo a la interfaz <code>Authenticatable</code>. Recuerda, el proveedor deberá retornar implementaciones de esta interfaz desde los métodos <code>retrieveById</code>, <code>retrieveByToken</code> y <code>retrieveByCredentials</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Authenticatable</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getAuthIdentifierName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getAuthIdentifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getAuthPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getRememberToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">setRememberToken</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getRememberTokenName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Esta interfaz es simple. El método <code>getAuthIdentifierName</code> debe retornar el nombre del campo &quot;clave primaria&quot; del usuario y el método <code>getAuthIdentifier</code> deberá retornar la &quot;clave primaria&quot; del usuario. En un backend MySQL, nuevamente, esto deberá ser la clave auto-incrementable. El método <code>getAuthPassword</code> deberá retornar la contraseña encriptada del usuario. Esta interfaz permite que el sistema de autenticación funcione con cualquier clase de usuario, independientemente de qué capa de abstracción o qué ORM se está utilizando. Por defecto, Laravel incluye una clase <code>User</code> en el directorio <code>app</code> que implementa esta interfaz, por lo que puedes consultar esta clase para obtener un ejemplo de implementación.</p> <p><a name="events"></a></p> <h2 id="eventos"><a href="#eventos" class="header-anchor">#</a> Eventos</h2> <p>Laravel genera una variedad de <a href="/events.html">eventos</a> durante el proceso de autenticación. Puedes adjuntar listeners a estos eventos en tu <code>EventServiceProvider</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* The event listener mappings for the application.
*
* @var array
*/</span>
<span class="token keyword">protected</span> <span class="token variable">$listen</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'Illuminate\Auth\Events\Registered'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'App\Listeners\LogRegisteredUser'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token string single-quoted-string">'Illuminate\Auth\Events\Attempting'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'App\Listeners\LogAuthenticationAttempt'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token string single-quoted-string">'Illuminate\Auth\Events\Authenticated'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'App\Listeners\LogAuthenticated'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token string single-quoted-string">'Illuminate\Auth\Events\Login'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'App\Listeners\LogSuccessfulLogin'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token string single-quoted-string">'Illuminate\Auth\Events\Failed'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'App\Listeners\LogFailedLogin'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token string single-quoted-string">'Illuminate\Auth\Events\Logout'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'App\Listeners\LogSuccessfulLogout'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token string single-quoted-string">'Illuminate\Auth\Events\Lockout'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'App\Listeners\LogLockout'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token string single-quoted-string">'Illuminate\Auth\Events\PasswordReset'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'App\Listeners\LogPasswordReset'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e3311cd2.js" defer></script><script src="/assets/js/2.648c6578.js" defer></script><script src="/assets/js/9.d31992a0.js" defer></script>
  </body>
</html>
